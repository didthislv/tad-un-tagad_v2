<!DOCTYPE html>
<html lang="lv" data-theme="dark" data-lang="lv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#6c5ce7">
    <title>Tad un Tagad</title>
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/svg+xml" href="icon.svg">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600&display=swap');
        *{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}

        [data-theme="dark"]{
            --bg-primary:#0a0a0f;--bg-secondary:#101018;--bg-card:rgba(255,255,255,0.03);
            --text-primary:#e8e8ed;--text-secondary:#8888a0;--text-muted:#55556a;
            --accent-1:#6c5ce7;--accent-2:#a855f7;--accent-3:#ec4899;
            --accent-glow:rgba(108,92,231,0.3);--border:rgba(255,255,255,0.06);
            --glass:rgba(255,255,255,0.04);--slider-track:rgba(255,255,255,0.06);
            --toast-success-bg:rgba(34,197,94,0.15);--toast-success-text:#86efac;--toast-success-border:rgba(34,197,94,0.2);
            --toast-warning-bg:rgba(234,179,8,0.15);--toast-warning-text:#fde68a;--toast-warning-border:rgba(234,179,8,0.2);
            --error-bg:rgba(239,68,68,0.08);--error-border:rgba(239,68,68,0.2);--error-text:#f87171;
            --danger-bg:rgba(239,68,68,0.1);--danger-text:#f87171;--danger-border:rgba(239,68,68,0.15);
            --status-bg:rgba(0,0,0,0.7);--pill-bg:rgba(168,85,247,0.1);
            --mesh-1:rgba(108,92,231,0.08);--mesh-2:rgba(168,85,247,0.06);--mesh-3:rgba(236,72,153,0.05);
            --comp-then-bg:rgba(108,92,231,0.3);--comp-then-text:#c4b5fd;
            --comp-now-bg:rgba(236,72,153,0.3);--comp-now-text:#f9a8d4;
            --vf-color:rgba(108,92,231,0.5);--thumb-border:rgba(255,255,255,0.2);
            --save-then:#c4b5fd;--save-now:#f9a8d4;
            --modal-bg:rgba(10,10,15,0.95);
        }
        [data-theme="light"]{
            --bg-primary:#f5f5f7;--bg-secondary:#eeeef0;--bg-card:rgba(0,0,0,0.02);
            --text-primary:#1a1a2e;--text-secondary:#6b6b80;--text-muted:#9999aa;
            --accent-1:#6c5ce7;--accent-2:#9333ea;--accent-3:#db2777;
            --accent-glow:rgba(108,92,231,0.2);--border:rgba(0,0,0,0.08);
            --glass:rgba(0,0,0,0.03);--slider-track:rgba(0,0,0,0.08);
            --toast-success-bg:rgba(34,197,94,0.12);--toast-success-text:#15803d;--toast-success-border:rgba(34,197,94,0.25);
            --toast-warning-bg:rgba(234,179,8,0.12);--toast-warning-text:#a16207;--toast-warning-border:rgba(234,179,8,0.25);
            --error-bg:rgba(239,68,68,0.06);--error-border:rgba(239,68,68,0.2);--error-text:#dc2626;
            --danger-bg:rgba(239,68,68,0.08);--danger-text:#dc2626;--danger-border:rgba(239,68,68,0.18);
            --status-bg:rgba(255,255,255,0.85);--pill-bg:rgba(147,51,234,0.1);
            --mesh-1:rgba(108,92,231,0.05);--mesh-2:rgba(147,51,234,0.04);--mesh-3:rgba(219,39,119,0.03);
            --comp-then-bg:rgba(108,92,231,0.15);--comp-then-text:#5b21b6;
            --comp-now-bg:rgba(219,39,119,0.15);--comp-now-text:#9d174d;
            --vf-color:rgba(108,92,231,0.4);--thumb-border:rgba(255,255,255,0.6);
            --save-then:#6c5ce7;--save-now:#db2777;
            --modal-bg:rgba(245,245,247,0.97);
        }

        body{font-family:'Inter',sans-serif;background:var(--bg-primary);color:var(--text-primary);min-height:100vh;overflow:hidden;position:fixed;width:100%;height:100%;transition:background 0.4s ease,color 0.4s ease}
        .bg-mesh{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:0;overflow:hidden}
        .bg-mesh::before{content:'';position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:radial-gradient(ellipse at 20% 50%,var(--mesh-1) 0%,transparent 50%),radial-gradient(ellipse at 80% 20%,var(--mesh-2) 0%,transparent 50%),radial-gradient(ellipse at 50% 80%,var(--mesh-3) 0%,transparent 50%);animation:meshMove 20s ease-in-out infinite alternate}
        @keyframes meshMove{0%{transform:translate(0,0) rotate(0deg)}100%{transform:translate(-5%,-3%) rotate(3deg)}}
        .container{position:relative;z-index:1;width:100%;height:100vh;height:100dvh;display:flex;flex-direction:column;overflow:hidden}

        header{text-align:center;padding:8px 16px 4px;flex-shrink:0;display:flex;align-items:center;justify-content:center;position:relative}
        .header-content{text-align:center}
        .logo-row{display:flex;align-items:center;justify-content:center;gap:10px;margin-bottom:1px}
        .logo-icon{width:30px;height:30px;display:flex;align-items:center;justify-content:center;filter:drop-shadow(0 2px 8px var(--accent-glow)) drop-shadow(0 0 15px rgba(108,92,231,0.6))}
        .logo-icon svg{width:100%;height:100%}
        h1{font-family:'Space Grotesk',sans-serif;font-size:clamp(1.1rem,4vw,1.5rem);font-weight:700;letter-spacing:-0.02em;color:#6c5ce7;text-shadow:0 0 20px rgba(108,92,231,0.5)}
        .subtitle{font-size:0.65rem;color:var(--text-muted);letter-spacing:0.05em;text-shadow:0 1px 3px rgba(0,0,0,0.5)}

        .header-toggle{position:absolute;top:50%;transform:translateY(-50%);height:22px;border-radius:50px;background:var(--glass);border:2px solid var(--accent-1);cursor:pointer;display:flex;align-items:center;padding:2px;transition:all 0.4s cubic-bezier(0.4,0,0.2,1);touch-action:manipulation;box-shadow:0 0 10px var(--accent-glow)}
        .header-toggle:active{transform:translateY(-50%) scale(0.92)}
        .toggle-knob{width:16px;height:16px;border-radius:50%;background:linear-gradient(135deg,var(--accent-1),var(--accent-2));display:flex;align-items:center;justify-content:center;transition:all 0.4s cubic-bezier(0.4,0,0.2,1);box-shadow:0 2px 8px var(--accent-glow)}
        .toggle-knob i{font-size:8px;color:white}
        .lang-toggle{left:16px;width:48px}
        .lang-toggle .toggle-knob{font-family:'Space Grotesk',sans-serif;font-size:7px;font-weight:700;letter-spacing:0.03em;color:white}
        .lang-toggle .toggle-knob i{display:none}
        [data-lang="en"] .lang-toggle .toggle-knob{transform:translateX(26px)}
        [data-theme="light"] .lang-toggle{background:rgba(0,0,0,0.06)}
        .lang-label{position:absolute;top:50%;transform:translateY(-50%);font-family:'Space Grotesk',sans-serif;font-size:6.5px;font-weight:600;color:var(--text-muted);pointer-events:none;letter-spacing:0.02em;transition:opacity 0.3s ease}
        .lang-label.left{left:6px}.lang-label.right{right:6px}
        [data-lang="lv"] .lang-label.left{opacity:0}[data-lang="en"] .lang-label.right{opacity:0}
        .theme-toggle{right:16px;width:40px}
        [data-theme="light"] .theme-toggle .toggle-knob{transform:translateX(18px)}
        [data-theme="light"] .theme-toggle{background:rgba(0,0,0,0.06)}

        .upload-section{background:var(--bg-card);backdrop-filter:blur(20px);border:3px solid;border-radius:16px;padding:40px 24px;margin:16px;text-align:center;transition:all 0.4s cubic-bezier(0.4,0,0.2,1);cursor:pointer;position:relative;overflow:visible;flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;border-image:linear-gradient(90deg,#6c5ce7,#a855f7,#ec4899,#a855f7,#6c5ce7) 1;animation:rotateBorder 4s linear infinite;background-size:400% 400%}
        @keyframes rotateBorder{0%{border-image:linear-gradient(90deg,#6c5ce7,#a855f7,#ec4899,#a855f7,#6c5ce7) 1}25%{border-image:linear-gradient(180deg,#a855f7,#ec4899,#6c5ce7,#a855f7,#ec4899) 1}50%{border-image:linear-gradient(270deg,#ec4899,#6c5ce7,#a855f7,#ec4899,#6c5ce7) 1}75%{border-image:linear-gradient(0deg,#6c5ce7,#ec4899,#a855f7,#6c5ce7,#ec4899) 1}100%{border-image:linear-gradient(90deg,#6c5ce7,#a855f7,#ec4899,#a855f7,#6c5ce7) 1}}
        .upload-section:active{transform:scale(0.98)}
        .upload-section.active{display:none;pointer-events:none}

        .upload-icon-wrapper{width:120px;height:100px;display:flex;align-items:center;justify-content:center;margin:0 auto 20px;animation:breathe 4s ease-in-out infinite;filter:drop-shadow(0 4px 20px var(--accent-glow))}
        .upload-icon-wrapper svg{width:100%;height:100%}
        @keyframes breathe{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}

        .upload-section h2{font-family:'Space Grotesk',sans-serif;font-size:1rem;font-weight:600;margin-bottom:8px}
        .upload-hint{font-size:0.73rem;color:var(--text-muted);display:flex;align-items:center;gap:6px;justify-content:center}
        .upload-hint i{font-size:0.65rem;color:var(--accent-1)}
        input[type="file"]{display:none}

        .btn{font-family:'Space Grotesk',sans-serif;border:none;padding:9px 16px;border-radius:50px;font-size:0.75rem;font-weight:600;cursor:pointer;transition:all 0.3s cubic-bezier(0.4,0,0.2,1);touch-action:manipulation;display:inline-flex;align-items:center;gap:6px}
        .btn i{font-size:0.8rem}
        .btn-primary{background:linear-gradient(135deg,var(--accent-1),var(--accent-2));color:white;box-shadow:0 4px 15px var(--accent-glow)}
        .btn-primary:active{transform:scale(0.96)}
        .btn-ghost{background:var(--glass);color:var(--text-primary);border:1px solid var(--border)}
        .btn-ghost:active{transform:scale(0.96)}
        .btn-danger{background:var(--danger-bg);color:var(--danger-text);border:1px solid var(--danger-border)}
        .btn-danger:active{transform:scale(0.96)}

        .camera-container{display:none;position:relative;flex:1;min-height:0;margin:0 8px;border-radius:14px;overflow:hidden;border:1px solid var(--border);background:#000}
        .camera-container.active{display:block}
        #video-feed{width:100%;height:100%;display:block;background:#000;transform-origin:center;object-fit:cover}
        #historical-overlay{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:contain;pointer-events:none;transition:opacity 0.3s ease}

        .viewfinder{position:absolute;inset:12px;pointer-events:none;z-index:3}
        .vf-corner{position:absolute;width:20px;height:20px;border-color:var(--vf-color);border-style:solid;border-width:0}
        .vf-corner.tl{top:0;left:0;border-top-width:2px;border-left-width:2px;border-radius:3px 0 0 0}
        .vf-corner.tr{top:0;right:0;border-top-width:2px;border-right-width:2px;border-radius:0 3px 0 0}
        .vf-corner.bl{bottom:0;left:0;border-bottom-width:2px;border-left-width:2px;border-radius:0 0 0 3px}
        .vf-corner.br{bottom:0;right:0;border-bottom-width:2px;border-right-width:2px;border-radius:0 0 3px 0}

        .status-pill{display:none;position:absolute;bottom:8px;left:50%;transform:translateX(-50%);padding:4px 12px;border-radius:20px;font-family:'Space Grotesk',sans-serif;font-size:0.6rem;font-weight:500;background:var(--status-bg);backdrop-filter:blur(10px);border:1px solid var(--border);color:var(--text-secondary);z-index:4}
        .status-pill.active{display:block;animation:fadeInUp 0.4s ease}
        .status-pill .dot{display:inline-block;width:5px;height:5px;border-radius:50%;background:#22c55e;margin-right:5px;animation:blink 2s ease-in-out infinite}
        @keyframes blink{0%,100%{opacity:1}50%{opacity:0.3}}
        @keyframes fadeInUp{from{opacity:0;transform:translateX(-50%) translateY(10px)}to{opacity:1;transform:translateX(-50%) translateY(0)}}

        .controls-panel{background:var(--bg-secondary);border-top:1px solid var(--border);padding:8px 12px 6px;flex-shrink:0;transition:background 0.4s ease}
        .control-group{margin-bottom:6px}.control-group:last-child{margin-bottom:0}
        .control-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:4px}
        .control-label{font-family:'Space Grotesk',sans-serif;font-size:0.68rem;font-weight:500;color:var(--text-secondary)}
        .control-label i{margin-right:5px}
        .control-value{font-family:'Space Grotesk',sans-serif;font-size:0.65rem;font-weight:600;color:var(--accent-2);background:var(--pill-bg);padding:1px 7px;border-radius:20px}

        input[type="range"]{width:100%;height:3px;border-radius:3px;background:var(--slider-track);outline:none;-webkit-appearance:none}
        input[type="range"]::-webkit-slider-thumb{-webkit-appearance:none;width:16px;height:16px;border-radius:50%;background:linear-gradient(135deg,var(--accent-1),var(--accent-2));cursor:pointer;box-shadow:0 0 8px var(--accent-glow);border:2px solid var(--thumb-border)}
        input[type="range"]::-webkit-slider-thumb:active{transform:scale(1.3)}
        input[type="range"]::-moz-range-thumb{width:16px;height:16px;border-radius:50%;background:linear-gradient(135deg,var(--accent-1),var(--accent-2));cursor:pointer;border:2px solid var(--thumb-border)}

        .slider-comparison{position:absolute;top:0;left:0;width:100%;height:100%;overflow:hidden;display:none;background:#000;z-index:10}
        .slider-comparison.active{display:block}
        #captured-image,#historical-comparison{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:contain}
        #historical-comparison{clip-path:inset(0 50% 0 0);z-index:2}#captured-image{z-index:1}
        .slider-divider{position:absolute;top:0;left:50%;width:2px;height:100%;background:linear-gradient(180deg,var(--accent-1),var(--accent-2),var(--accent-3));transform:translateX(-50%);box-shadow:0 0 12px var(--accent-glow);pointer-events:none;z-index:5}
        .comparison-labels{position:absolute;top:10px;left:0;width:100%;display:flex;justify-content:space-between;padding:0 12px;pointer-events:none;z-index:6}
        .comp-label{font-family:'Space Grotesk',sans-serif;font-size:0.6rem;font-weight:600;text-transform:uppercase;letter-spacing:0.1em;padding:3px 10px;border-radius:20px;backdrop-filter:blur(10px)}
        .comp-label.then{background:var(--comp-then-bg);color:var(--comp-then-text);border:1px solid var(--comp-then-bg)}
        .comp-label.now{background:var(--comp-now-bg);color:var(--comp-now-text);border:1px solid var(--comp-now-bg)}

        .comparison-slider{width:100%;height:6px;border-radius:6px;background:var(--slider-track);outline:none;-webkit-appearance:none}
        .comparison-slider::-webkit-slider-thumb{-webkit-appearance:none;width:40px;height:40px;border-radius:50%;background:linear-gradient(135deg,var(--accent-1),var(--accent-2));cursor:pointer;box-shadow:0 0 20px var(--accent-glow),0 4px 12px rgba(0,0,0,0.3);border:3px solid var(--thumb-border)}
        .comparison-slider::-moz-range-thumb{width:40px;height:40px;border-radius:50%;background:linear-gradient(135deg,var(--accent-1),var(--accent-2));cursor:pointer;border:3px solid var(--thumb-border)}

        .action-buttons{display:flex;gap:6px;justify-content:center;flex-wrap:wrap}
        .slider-hint{display:none;text-align:center;margin-top:6px;font-family:'Inter',sans-serif;font-size:0.63rem;color:var(--text-muted);animation:hintPulse 2.5s ease-in-out infinite}
        .slider-hint.active{display:flex;align-items:center;justify-content:center;gap:8px}
        .slider-hint i{font-size:0.55rem;color:var(--accent-2)}
        @keyframes hintPulse{0%,100%{opacity:0.4}50%{opacity:1}}

        .app-footer{text-align:center;padding:4px 10px;flex-shrink:0;font-family:'Space Grotesk',sans-serif;font-size:0.55rem;letter-spacing:0.08em;color:var(--text-muted);display:flex;align-items:center;justify-content:center;position:relative}
        
        .info-btn{position:absolute;right:15px;top:20%;transform:translateY(-50%);width:22px;height:22px;border-radius:50%;background:var(--glass);border:2px solid var(--accent-1);color:var(--accent-1);font-size:11px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all 0.3s ease;touch-action:manipulation;box-shadow:0 0 10px var(--accent-glow)}
        .info-btn:hover{background:rgba(108,92,231,0.15);border-color:var(--accent-1)}
        .info-btn:active{transform:translateY(-50%) scale(0.9)}

        .info-modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.6);backdrop-filter:blur(8px);z-index:9998;display:none;align-items:center;justify-content:center;padding:20px;animation:modalFadeIn 0.3s ease}
        .info-modal-overlay.active{display:flex}
        @keyframes modalFadeIn{from{opacity:0}to{opacity:1}}

        .info-modal{background:var(--modal-bg);border:1px solid var(--border);border-radius:20px;width:100%;max-width:400px;max-height:80vh;overflow-y:auto;padding:24px;position:relative;animation:modalSlideUp 0.4s cubic-bezier(0.4,0,0.2,1)}
        @keyframes modalSlideUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}
        .info-modal::-webkit-scrollbar{width:4px}
        .info-modal::-webkit-scrollbar-track{background:transparent}
        .info-modal::-webkit-scrollbar-thumb{background:var(--accent-1);border-radius:4px}

        .info-close{position:absolute;top:16px;right:16px;width:28px;height:28px;border-radius:50%;background:var(--glass);border:1px solid var(--border);color:var(--text-secondary);font-size:14px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all 0.3s ease}
        .info-close:hover{background:rgba(239,68,68,0.15);color:var(--error-text);border-color:rgba(239,68,68,0.3)}

        .info-modal-logo{width:60px;height:50px;margin:0 auto 12px;filter:drop-shadow(0 4px 15px var(--accent-glow))}
        .info-modal-logo svg{width:100%;height:100%}

        .info-modal h2{font-family:'Space Grotesk',sans-serif;font-size:1.1rem;font-weight:700;text-align:center;margin-bottom:4px;background:linear-gradient(135deg,var(--accent-1),var(--accent-2));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}

        .info-modal .info-subtitle{text-align:center;font-size:0.7rem;color:var(--text-muted);margin-bottom:16px}

        .info-section{margin-bottom:14px}
        .info-section h3{font-family:'Space Grotesk',sans-serif;font-size:0.75rem;font-weight:600;color:var(--accent-2);margin-bottom:6px;display:flex;align-items:center;gap:6px}
        .info-section h3 i{font-size:0.7rem}

        .info-section p,.info-section li{font-size:0.7rem;line-height:1.6;color:var(--text-secondary)}

        .info-section ul{list-style:none;padding:0}
        .info-section li{padding:3px 0;padding-left:16px;position:relative}
        .info-section li::before{content:'';position:absolute;left:0;top:10px;width:6px;height:6px;border-radius:50%;background:linear-gradient(135deg,var(--accent-1),var(--accent-2))}

        .info-video-container{margin:16px 0;border-radius:12px;overflow:hidden;background:var(--bg-card);border:1px solid var(--border)}
        .info-video-container video{width:100%;height:auto;display:block;border-radius:12px}
        .info-video-title{font-family:'Space Grotesk',sans-serif;font-size:0.75rem;font-weight:600;color:var(--accent-2);margin-bottom:8px;display:flex;align-items:center;gap:6px}
        .info-video-title i{font-size:0.7rem}

        .info-version{text-align:center;font-family:'Space Grotesk',sans-serif;font-size:0.6rem;color:var(--text-muted);margin-top:16px;padding-top:12px;border-top:1px solid var(--border)}

        .toast{position:fixed;top:16px;left:50%;transform:translateX(-50%) translateY(-100px);padding:10px 20px;border-radius:50px;font-family:'Space Grotesk',sans-serif;font-size:0.75rem;font-weight:500;z-index:10000;backdrop-filter:blur(20px);transition:transform 0.5s cubic-bezier(0.4,0,0.2,1);display:flex;align-items:center;gap:8px;white-space:nowrap}
        .toast.show{transform:translateX(-50%) translateY(0)}
        .toast.success{background:var(--toast-success-bg);color:var(--toast-success-text);border:1px solid var(--toast-success-border)}
        .toast.warning{background:var(--toast-warning-bg);color:var(--toast-warning-text);border:1px solid var(--toast-warning-border)}
        .toast i{font-size:0.9rem}

        .error-message{background:var(--error-bg);border:1px solid var(--error-border);border-radius:10px;padding:14px 18px;margin:10px 16px;text-align:center}
        .error-message h3{font-family:'Space Grotesk',sans-serif;margin-bottom:4px;color:var(--error-text);font-size:0.85rem}
        .error-message p{font-size:0.75rem;color:var(--text-secondary);margin-bottom:10px}
        .error-message .btn{margin-top:8px}
        .loading{text-align:center;padding:16px;font-family:'Space Grotesk',sans-serif;color:var(--accent-2);font-size:0.8rem;display:flex;align-items:center;justify-content:center;gap:8px}
        .loading-dots{display:inline-flex;gap:3px}
        .loading-dots span{width:4px;height:4px;border-radius:50%;background:var(--accent-2);animation:loadDot 1.4s ease-in-out infinite}
        .loading-dots span:nth-child(2){animation-delay:0.2s}.loading-dots span:nth-child(3){animation-delay:0.4s}
        @keyframes loadDot{0%,80%,100%{opacity:0.2;transform:scale(0.8)}40%{opacity:1;transform:scale(1.2)}}
        canvas{display:none}#download-link{display:none}
        @media(max-width:768px){.action-buttons{flex-direction:column}.btn{width:100%;justify-content:center}}
        .camera-container,.controls-panel{animation:slideUp 0.5s cubic-bezier(0.4,0,0.2,1)}
        @keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
    </style>
</head>
<body>
    <div class="bg-mesh"></div>
    <div class="toast" id="toast"><i id="toastIcon"></i><span id="toastText"></span></div>

    <!-- INFO MODĀLIS -->
    <div class="info-modal-overlay" id="infoModal" onclick="if(event.target===this)closeInfo()">
        <div class="info-modal">
            <button class="info-close" onclick="closeInfo()"><i class="fa-solid fa-xmark"></i></button>
            
            <div class="info-modal-logo">
                <svg viewBox="80 185 452 490" xmlns="http://www.w3.org/2000/svg">
                    <path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 220.478,429.458 c 0,47.264 38.365,85.629 85.629,85.629 47.264,0 85.629,-38.365 85.629,-85.629"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 163.392,429.458 c 0,78.774 63.936,142.715 142.715,142.715 32.116,0 61.765,-10.627 85.619,-28.553"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 220.478,429.458 V 248.684"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 163.392,429.458 V 248.684"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 391.736,315.286 V 248.684"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 448.822,429.458 V 248.684"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 163.392,248.684 H 87.274"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 87.274,248.684 V 191.598"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 87.274,191.598 H 296.591"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 296.591,248.684 H 220.478"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 391.736,248.684 h -76.118"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 315.618,248.684 V 191.598"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 296.591,248.684 V 191.598"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 315.618,191.598 H 524.935"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 524.935,191.598 v 57.086"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 524.935,248.684 h -76.113"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 306.107,515.087 c 47.264,0 85.629,-38.365 85.629,-85.629 0,-47.264 -38.365,-85.629 -85.629,-85.629 -43.44,0 -85.629,38.365 -85.629,85.629"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 448.822,429.458 c 0,-78.774 -63.941,-142.715 -142.715,-142.715 -32.116,0 -61.765,10.627 -85.624,28.553"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 220.478,543.63 v 66.597"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 163.392,429.458 V 610.227"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 391.736,429.458 V 610.227"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 448.822,429.458 V 610.227"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 163.392,610.227 H 87.274"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 87.274,610.227 v 57.086"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 87.274,667.313 H 296.591"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 296.591,610.227 H 220.478"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 391.736,610.227 h -76.118"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 315.618,610.227 v 57.086"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 296.591,610.227 v 57.086"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 315.618,667.313 H 524.935"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 524.935,667.313 V 610.227"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 524.935,610.227 h -76.113"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 306.107,286.743 v 57.086"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 306.107,515.087 v 57.086"/>
                    <path fill="#6c5ce7" stroke="#6c5ce7" stroke-width="3.36" d="m 281.937,567.365 c -18.693,-3.298 -39.337,-11.862 -55.874,-23.176 -10.335,-7.072 -27.732,-24.506 -34.916,-34.991 -8.344,-12.179 -16.814,-30.622 -20.73,-45.14 l -3.399,-12.6 -0.313,-101.571 c -0.22,-71.234 -0.659,-101.988 -1.472,-102.967 -0.915,-1.103 -8.949,-1.396 -38.277,-1.396 H 89.839 v -25.542 -25.542 h 102.169 102.169 v 25.542 25.542 h -37.119 c -30.522,0 -37.338,0.265 -38.355,1.49 -0.925,1.115 -1.153,25.992 -0.904,98.71 0.332,97.089 0.336,97.231 2.727,105.734 10.136,36.043 37.497,60.074 74.57,65.495 l 8.659,1.266 v 25.42 25.42 l -6.652,-0.096 c -3.658,-0.053 -10.483,-0.772 -15.166,-1.598 z"/>
                    <path fill="#6c5ce7" stroke="#6c5ce7" stroke-width="2.21" d="m 318.654,638.767 v -26.074 h 37.781 37.781 v -96.36 c 0,-83.766 -0.221,-97.432 -1.686,-104.563 -7.673,-37.337 -38.947,-65.842 -76.803,-70.006 l -6.652,-0.732 v -25.99 -25.99 l 6.652,0.663 c 3.658,0.364 10.662,1.373 15.564,2.24 53.265,9.431 96.881,50.153 110.277,102.96 4.487,17.686 4.797,25.72 4.797,124.08 v 93.697 h 37.781 37.781 v 26.074 26.074 H 420.291 318.654 Z"/>
                </svg>
            </div>

            <h2 data-lv="Tad un Tagad" data-en="Then and Today">Tad un Tagad</h2>
            <p class="info-subtitle" data-lv="Vēsturisko un mūsdienu foto salīdzināšana" data-en="Historical and modern photo comparison">Vēsturisko un mūsdienu foto salīdzināšana</p>

            <div class="info-section">
                <h3 class="info-video-title"><i class="fa-solid fa-circle-play"></i> <span data-lv="Video piemērs" data-en="Video example">Video piemērs</span></h3>
                <div class="info-video-container">
                    <video controls preload="metadata" playsinline>
                        <source src="piemers_1.mp4" type="video/mp4">
                        <span data-lv="Tavs pārlūks neatbalsta video atskaņošanu" data-en="Your browser doesn't support video playback">Tavs pārlūks neatbalsta video atskaņošanu</span>
                    </video>
                </div>
            </div>

            <div class="info-section">
                <h3><i class="fa-solid fa-bullseye"></i> <span data-lv="Kā lietot" data-en="How to use">Kā lietot</span></h3>
                <ul>
                    <li data-lv="Augšupielādē vēsturisko fotoattēlu" data-en="Upload a historical photo">Augšupielādē vēsturisko fotoattēlu</li>
                    <li data-lv="Atļauj kameras piekļuvi" data-en="Allow camera access">Atļauj kameras piekļuvi</li>
                    <li data-lv="Regulē caurspīdīgumu un tālummaiņu" data-en="Adjust opacity and zoom">Regulē caurspīdīgumu un tālummaiņu</li>
                    <li data-lv="Uzņem foto, kad skats sakrīt" data-en="Capture when aligned">Uzņem foto, kad skats sakrīt</li>
                    <li data-lv="Izmanto slīdni, lai salīdzinātu" data-en="Use slider to compare">Izmanto slīdni, lai salīdzinātu</li>
                    <li data-lv="Saglabā rezultātu" data-en="Save the result">Saglabā rezultātu</li>
                </ul>
            </div>

            <div class="info-section">
                <h3><i class="fa-solid fa-star"></i> <span data-lv="Funkcijas" data-en="Features">Funkcijas</span></h3>
                <ul>
                    <li data-lv="Reāllaika kameras overlay" data-en="Real-time camera overlay">Reāllaika kameras overlay</li>
                    <li data-lv="Caurspīdīguma kontrole (0-100%)" data-en="Opacity control (0-100%)">Caurspīdīguma kontrole (0-100%)</li>
                    <li data-lv="Digitālā tālummaiņa (1x-3x)" data-en="Digital zoom (1x-3x)">Digitālā tālummaiņa (1x-3x)</li>
                    <li data-lv="Interaktīvs salīdzināšanas slaideris" data-en="Interactive comparison slider">Interaktīvs salīdzināšanas slaideris</li>
                    <li data-lv="Salīdzinājuma saglabāšana (JPG)" data-en="Save comparison (JPG)">Salīdzinājuma saglabāšana (JPG)</li>
                    <li data-lv="Gaišā / tumšā tēma" data-en="Light / dark theme">Gaišā / tumšā tēma</li>
                    <li data-lv="Latviešu un angļu valoda" data-en="Latvian and English language">Latviešu un angļu valoda</li>
                    <li data-lv="Darbojas offline (PWA)" data-en="Works offline (PWA)">Darbojas offline (PWA)</li>
                </ul>
            </div>

            <div class="info-section">
                <h3><i class="fa-solid fa-circle-info"></i> <span data-lv="Prasības" data-en="Requirements">Prasības</span></h3>
                <ul>
                    <li data-lv="HTTPS savienojums kameras piekļuvei" data-en="HTTPS connection for camera access">HTTPS savienojums kameras piekļuvei</li>
                    <li data-lv="Moderna pārlūkprogramma" data-en="Modern web browser">Moderna pārlūkprogramma</li>
                    <li data-lv="Ierīce ar kameru" data-en="Device with camera">Ierīce ar kameru</li>
                </ul>
            </div>

            <div class="info-version">© DS 2025 v2.1</div>
        </div>
    </div>
    
    <div class="container">
        <header>
            <div class="header-toggle lang-toggle" onclick="toggleLang()">
                <span class="lang-label left">LV</span>
                <div class="toggle-knob" id="langKnob">LV</div>
                <span class="lang-label right">EN</span>
            </div>
            <div class="header-content">
                <div class="logo-row">
                    <div class="logo-icon">
                        <svg viewBox="80 185 452 490" xmlns="http://www.w3.org/2000/svg"><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 220.478,429.458 c 0,47.264 38.365,85.629 85.629,85.629 47.264,0 85.629,-38.365 85.629,-85.629"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 163.392,429.458 c 0,78.774 63.936,142.715 142.715,142.715 32.116,0 61.765,-10.627 85.619,-28.553"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 220.478,429.458 V 248.684"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 163.392,429.458 V 248.684"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 391.736,315.286 V 248.684"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 448.822,429.458 V 248.684"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 163.392,248.684 H 87.274"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 87.274,248.684 V 191.598"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 87.274,191.598 H 296.591"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 296.591,248.684 H 220.478"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 391.736,248.684 h -76.118"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 315.618,248.684 V 191.598"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 296.591,248.684 V 191.598"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 315.618,191.598 H 524.935"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 524.935,191.598 v 57.086"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 524.935,248.684 h -76.113"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 306.107,515.087 c 47.264,0 85.629,-38.365 85.629,-85.629 0,-47.264 -38.365,-85.629 -85.629,-85.629 -43.44,0 -85.629,38.365 -85.629,85.629"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 448.822,429.458 c 0,-78.774 -63.941,-142.715 -142.715,-142.715 -32.116,0 -61.765,10.627 -85.624,28.553"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 220.478,543.63 v 66.597"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 163.392,429.458 V 610.227"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 391.736,429.458 V 610.227"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 448.822,429.458 V 610.227"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 163.392,610.227 H 87.274"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 87.274,610.227 v 57.086"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 87.274,667.313 H 296.591"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 296.591,610.227 H 220.478"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 391.736,610.227 h -76.118"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 315.618,610.227 v 57.086"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 296.591,610.227 v 57.086"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 315.618,667.313 H 524.935"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 524.935,667.313 V 610.227"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 524.935,610.227 h -76.113"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 306.107,286.743 v 57.086"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 306.107,515.087 v 57.086"/><path fill="#6c5ce7" stroke="#6c5ce7" stroke-width="3.36" d="m 281.937,567.365 c -18.693,-3.298 -39.337,-11.862 -55.874,-23.176 -10.335,-7.072 -27.732,-24.506 -34.916,-34.991 -8.344,-12.179 -16.814,-30.622 -20.73,-45.14 l -3.399,-12.6 -0.313,-101.571 c -0.22,-71.234 -0.659,-101.988 -1.472,-102.967 -0.915,-1.103 -8.949,-1.396 -38.277,-1.396 H 89.839 v -25.542 -25.542 h 102.169 102.169 v 25.542 25.542 h -37.119 c -30.522,0 -37.338,0.265 -38.355,1.49 -0.925,1.115 -1.153,25.992 -0.904,98.71 0.332,97.089 0.336,97.231 2.727,105.734 10.136,36.043 37.497,60.074 74.57,65.495 l 8.659,1.266 v 25.42 25.42 l -6.652,-0.096 c -3.658,-0.053 -10.483,-0.772 -15.166,-1.598 z"/><path fill="#6c5ce7" stroke="#6c5ce7" stroke-width="2.21" d="m 318.654,638.767 v -26.074 h 37.781 37.781 v -96.36 c 0,-83.766 -0.221,-97.432 -1.686,-104.563 -7.673,-37.337 -38.947,-65.842 -76.803,-70.006 l -6.652,-0.732 v -25.99 -25.99 l 6.652,0.663 c 3.658,0.364 10.662,1.373 15.564,2.24 53.265,9.431 96.881,50.153 110.277,102.96 4.487,17.686 4.797,25.72 4.797,124.08 v 93.697 h 37.781 37.781 v 26.074 26.074 H 420.291 318.654 Z"/></svg>
                    </div>
                    <h1 data-lv="Tad un Tagad" data-en="Then and Today">Tad un Tagad</h1>
                </div>
                <p class="subtitle" data-lv="Salīdzini vēsturi ar tagadni" data-en="Compare history with the present">Salīdzini vēsturi ar tagadni</p>
            </div>
            <div class="header-toggle theme-toggle" onclick="toggleTheme()">
                <div class="toggle-knob"><i class="fa-solid fa-moon" id="themeIcon"></i></div>
            </div>
        </header>

        <div class="upload-section" id="uploadSection" onclick="document.getElementById('historicalInput').click()">
            <div class="upload-icon-wrapper">
                <svg viewBox="80 185 452 490" xmlns="http://www.w3.org/2000/svg"><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 220.478,429.458 c 0,47.264 38.365,85.629 85.629,85.629 47.264,0 85.629,-38.365 85.629,-85.629"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 163.392,429.458 c 0,78.774 63.936,142.715 142.715,142.715 32.116,0 61.765,-10.627 85.619,-28.553"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 220.478,429.458 V 248.684"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 163.392,429.458 V 248.684"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 391.736,315.286 V 248.684"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 448.822,429.458 V 248.684"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 163.392,248.684 H 87.274"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 87.274,248.684 V 191.598"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 87.274,191.598 H 296.591"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 296.591,248.684 H 220.478"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 391.736,248.684 h -76.118"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 315.618,248.684 V 191.598"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 296.591,248.684 V 191.598"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 315.618,191.598 H 524.935"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 524.935,191.598 v 57.086"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 524.935,248.684 h -76.113"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 306.107,515.087 c 47.264,0 85.629,-38.365 85.629,-85.629 0,-47.264 -38.365,-85.629 -85.629,-85.629 -43.44,0 -85.629,38.365 -85.629,85.629"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 448.822,429.458 c 0,-78.774 -63.941,-142.715 -142.715,-142.715 -32.116,0 -61.765,10.627 -85.624,28.553"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 220.478,543.63 v 66.597"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 163.392,429.458 V 610.227"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 391.736,429.458 V 610.227"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 448.822,429.458 V 610.227"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 163.392,610.227 H 87.274"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 87.274,610.227 v 57.086"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 87.274,667.313 H 296.591"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 296.591,610.227 H 220.478"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 391.736,610.227 h -76.118"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 315.618,610.227 v 57.086"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 296.591,610.227 v 57.086"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 315.618,667.313 H 524.935"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="M 524.935,667.313 V 610.227"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 524.935,610.227 h -76.113"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 306.107,286.743 v 57.086"/><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m 306.107,515.087 v 57.086"/><path fill="#6c5ce7" stroke="#6c5ce7" stroke-width="3.36" d="m 281.937,567.365 c -18.693,-3.298 -39.337,-11.862 -55.874,-23.176 -10.335,-7.072 -27.732,-24.506 -34.916,-34.991 -8.344,-12.179 -16.814,-30.622 -20.73,-45.14 l -3.399,-12.6 -0.313,-101.571 c -0.22,-71.234 -0.659,-101.988 -1.472,-102.967 -0.915,-1.103 -8.949,-1.396 -38.277,-1.396 H 89.839 v -25.542 -25.542 h 102.169 102.169 v 25.542 25.542 h -37.119 c -30.522,0 -37.338,0.265 -38.355,1.49 -0.925,1.115 -1.153,25.992 -0.904,98.71 0.332,97.089 0.336,97.231 2.727,105.734 10.136,36.043 37.497,60.074 74.57,65.495 l 8.659,1.266 v 25.42 25.42 l -6.652,-0.096 c -3.658,-0.053 -10.483,-0.772 -15.166,-1.598 z"/><path fill="#6c5ce7" stroke="#6c5ce7" stroke-width="2.21" d="m 318.654,638.767 v -26.074 h 37.781 37.781 v -96.36 c 0,-83.766 -0.221,-97.432 -1.686,-104.563 -7.673,-37.337 -38.947,-65.842 -76.803,-70.006 l -6.652,-0.732 v -25.99 -25.99 l 6.652,0.663 c 3.658,0.364 10.662,1.373 15.564,2.24 53.265,9.431 96.881,50.153 110.277,102.96 4.487,17.686 4.797,25.72 4.797,124.08 v 93.697 h 37.781 37.781 v 26.074 26.074 H 420.291 318.654 Z"/></svg>
            </div>
            <h2 data-lv="Augšupielādē vēsturisko attēlu" data-en="Upload historical photo">Augšupielādē vēsturisko attēlu</h2>
            <p class="upload-hint"><i class="fa-solid fa-hand-pointer"></i><span data-lv="Noklikšķini šeit, lai izvēlētos attēlu" data-en="Tap here to choose a photo">Noklikšķini šeit, lai izvēlētos attēlu</span></p>
            <input type="file" id="historicalInput" accept="image/*">
            <input type="file" id="modernInput" accept="image/*" style="display:none">
        </div>

        <div id="errorContainer"></div>

        <div class="camera-container" id="cameraContainer">
            <video id="video-feed" autoplay playsinline muted></video>
            <img id="historical-overlay" alt="">
            <canvas id="snapshot-canvas"></canvas>
            <div class="viewfinder" id="viewfinder"><div class="vf-corner tl"></div><div class="vf-corner tr"></div><div class="vf-corner bl"></div><div class="vf-corner br"></div></div>
            <div class="status-pill" id="statusPill"><span class="dot"></span><span data-lv="Kamera aktīva" data-en="Camera active">Kamera aktīva</span></div>
            <div class="slider-comparison" id="sliderComparison">
                <img id="captured-image" alt=""><img id="historical-comparison" alt="">
                <div class="slider-divider" id="sliderDivider"></div>
                <div class="comparison-labels"><span class="comp-label then" data-lv="Tad" data-en="Then">Tad</span><span class="comp-label now" data-lv="Tagad" data-en="Today">Tagad</span></div>
            </div>
        </div>

        <div class="controls-panel" id="controlsPanel" style="display:none">
            <div class="control-group" id="opacityGroup">
                <div class="control-header"><span class="control-label"><i class="fa-solid fa-eye" style="color:var(--accent-1)"></i><span data-lv="Caurspīdīgums" data-en="Opacity">Caurspīdīgums</span></span><span class="control-value" id="opacityValue">50%</span></div>
                <input type="range" id="opacitySlider" min="0" max="100" value="50">
            </div>
            <div class="control-group" id="zoomGroup">
                <div class="control-header"><span class="control-label"><i class="fa-solid fa-magnifying-glass-plus" style="color:var(--accent-2)"></i><span data-lv="Tālummaiņa" data-en="Zoom">Tālummaiņa</span></span><span class="control-value" id="zoomValue">1.0x</span></div>
                <input type="range" id="zoomSlider" min="100" max="300" value="100">
            </div>
            <div class="action-buttons">
                <button class="btn btn-primary" id="captureBtn" onclick="capturePhoto()"><i class="fa-solid fa-camera"></i><span data-lv="Uzņemt foto" data-en="Capture photo">Uzņemt foto</span></button>
                <button class="btn btn-ghost" id="compareBtn" style="display:none" onclick="toggleComparison()"><i class="fa-solid fa-repeat" id="compareBtnIcon"></i><span id="compareBtnText" data-lv="Salīdzināt" data-en="Compare" data-lv-alt="Atpakaļ" data-en-alt="Back">Salīdzināt</span></button>
                <button class="btn btn-ghost" id="saveBtn" style="display:none" onclick="saveComparison()"><i class="fa-solid fa-floppy-disk"></i><span data-lv="Saglabāt" data-en="Save">Saglabāt</span></button>
                <button class="btn btn-danger" id="resetBtn" onclick="resetApp()"><i class="fa-solid fa-rotate-left"></i><span data-lv="Sākt no jauna" data-en="Start over">Sākt no jauna</span></button>
            </div>
            <div class="control-group" id="uploadModernGroup" style="display:none">
                <div class="control-header"><span class="control-label"><i class="fa-solid fa-image" style="color:var(--accent-1)"></i><span data-lv="Mūsdienu foto" data-en="Modern photo">Mūsdienu foto</span></span></div>
                <button class="btn btn-primary" style="width:100%" onclick="document.getElementById('modernInput').click()"><i class="fa-solid fa-upload"></i><span data-lv="Ielādēt foto no ierīces" data-en="Upload photo from device">Ielādēt foto no ierīces</span></button>
            </div>
            <div class="control-group" id="comparisonSliderGroup" style="display:none;padding-top:15px">
                <input type="range" class="comparison-slider" id="comparisonSlider" min="0" max="100" value="50">
                <div class="slider-hint" id="sliderHint"><i class="fa-solid fa-arrow-left"></i><span data-lv="velc aplīti, lai salīdzinātu" data-en="drag to compare">velc aplīti, lai salīdzinātu</span><i class="fa-solid fa-arrow-right"></i></div>
            </div>
        </div>

        <footer class="app-footer">
            <span>© DS 2025 v2.1</span>
            <button class="info-btn" onclick="openInfo()" title="Info"><i class="fa-solid fa-info"></i></button>
        </footer>
    </div>
    <a id="download-link" download="tad-un-tagad.jpg"></a>

    <script>
        let stream=null,historicalImage=null,capturedImageData=null,currentZoom=1,isComparing=false;
        const translations={toasts:{cameraActive:{lv:'Kamera aktivizēta',en:'Camera activated'},photoCaptured:{lv:'Foto uzņemts veiksmīgi!',en:'Photo captured!'},captureFirst:{lv:'Vispirms uzņem foto!',en:'Capture a photo first!'},saved:{lv:'Salīdzinājums saglabāts!',en:'Comparison saved!'},confirmReset:{lv:'Vai tiešām vēlies sākt no jauna?',en:'Start over?'},httpsRequired:{lv:'Kamera darbojas tikai ar HTTPS.',en:'Camera requires HTTPS.'}},errors:{cameraFail:{lv:'Neizdevās piekļūt kamerai. ',en:'Could not access camera. '},notAllowed:{lv:'Atļauj kameras piekļuvi iestatījumos.',en:'Allow camera access in settings.'},notFound:{lv:'Kamera netika atrasta.',en:'Camera not found.'},notReadable:{lv:'Kamera tiek izmantota citur.',en:'Camera in use.'},generic:{lv:'Pārliecinies par kameras atļauju.',en:'Check camera permission.'},warning:{lv:'Brīdinājums',en:'Warning'},desktopUpload:{lv:'Izmanto pogu zemāk, lai ielādētu mūsdienu foto.',en:'Use the button below to upload modern photo.'}},loading:{camera:{lv:'Kameras aktivizēšana',en:'Activating camera'}},save:{then:{lv:'TAD',en:'THEN'},now:{lv:'TAGAD',en:'TODAY'}}};
        function t(c,k){return translations[c]?.[k]?.[document.documentElement.getAttribute('data-lang')||'lv']||'';}

        function openInfo(){document.getElementById('infoModal').classList.add('active');}
        function closeInfo(){document.getElementById('infoModal').classList.remove('active');}

        function toggleLang(){const h=document.documentElement,kn=document.getElementById('langKnob'),nw=h.getAttribute('data-lang')==='lv'?'en':'lv';h.setAttribute('data-lang',nw);h.setAttribute('lang',nw);kn.textContent=nw.toUpperCase();localStorage.setItem('lang',nw);document.querySelectorAll('[data-lv][data-en]').forEach(el=>{el.textContent=el.id==='compareBtnText'&&isComparing?el.getAttribute('data-'+nw+'-alt')||el.getAttribute('data-'+nw):el.getAttribute('data-'+nw);});}
        (function(){const s=localStorage.getItem('lang');if(s&&s!=='lv'){document.documentElement.setAttribute('data-lang',s);document.documentElement.setAttribute('lang',s);document.getElementById('langKnob').textContent=s.toUpperCase();document.querySelectorAll('[data-lv][data-en]').forEach(el=>el.textContent=el.getAttribute('data-'+s));}})();
        function toggleTheme(){const h=document.documentElement,i=document.getElementById('themeIcon');if(h.getAttribute('data-theme')==='dark'){h.setAttribute('data-theme','light');i.className='fa-solid fa-sun';localStorage.setItem('theme','light');}else{h.setAttribute('data-theme','dark');i.className='fa-solid fa-moon';localStorage.setItem('theme','dark');}}
        (function(){const s=localStorage.getItem('theme');if(s){document.documentElement.setAttribute('data-theme',s);document.getElementById('themeIcon').className=s==='light'?'fa-solid fa-sun':'fa-solid fa-moon';}})();
        function showToast(m,type='success'){const to=document.getElementById('toast');to.className='toast '+type;document.getElementById('toastIcon').className=type==='success'?'fa-solid fa-circle-check':'fa-solid fa-triangle-exclamation';document.getElementById('toastText').textContent=m;requestAnimationFrame(()=>to.classList.add('show'));setTimeout(()=>to.classList.remove('show'),3000);}
        function checkSecureContext(){if(!window.isSecureContext){showToast(t('toasts','httpsRequired'),'warning');return false;}return true;}
        let historicalInputUsed=false;
        document.getElementById('historicalInput').addEventListener('change',function(e){if(historicalInputUsed){console.warn('Historical input already used, ignoring');return;}const f=e.target.files[0];if(f){console.log('Historical photo selected:',f.name);historicalInputUsed=true;const r=new FileReader();r.onload=function(ev){historicalImage=ev.target.result;console.log('Historical photo loaded, historicalImage length:',historicalImage.length);document.getElementById('historical-overlay').src=historicalImage;document.getElementById('historical-comparison').src=historicalImage;document.getElementById('uploadSection').classList.add('active');document.getElementById('uploadSection').style.pointerEvents='none';if(checkSecureContext())startCamera();};r.readAsDataURL(f);}});
        document.getElementById('modernInput').addEventListener('change',function(e){const f=e.target.files[0];if(f){console.log('Modern photo selected:',f.name);const r=new FileReader();r.onload=function(ev){capturedImageData=ev.target.result;console.log('Modern photo loaded, capturedImageData length:',capturedImageData.length);document.getElementById('captured-image').src=capturedImageData;document.getElementById('compareBtn').style.display='inline-flex';document.getElementById('saveBtn').style.display='inline-flex';document.getElementById('uploadModernGroup').style.display='none';showToast(t('toasts','photoCaptured'));e.target.value='';};r.readAsDataURL(f);}});
        async function startCamera(){const ec=document.getElementById('errorContainer');ec.innerHTML=`<div class="loading">${t('loading','camera')}<div class="loading-dots"><span></span><span></span><span></span></div></div>`;try{stream=await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:'environment'},width:{ideal:1920},height:{ideal:1080}},audio:false});const v=document.getElementById('video-feed');v.srcObject=stream;v.onloadedmetadata=()=>{v.play();document.getElementById('cameraContainer').classList.add('active');document.getElementById('controlsPanel').style.display='block';document.getElementById('statusPill').classList.add('active');document.getElementById('uploadModernGroup').style.display='none';ec.innerHTML='';showToast(t('toasts','cameraActive'));};}catch(err){const isMobile=/Android|iPhone|iPad|iPod/i.test(navigator.userAgent);if(err.name==='NotAllowedError'&&isMobile){let m=t('errors','cameraFail')+t('errors','notAllowed');ec.innerHTML=`<div class="error-message"><h3><i class="fa-solid fa-triangle-exclamation" style="margin-right:6px"></i>${t('errors','warning')}</h3><p>${m}</p></div>`;return;}document.getElementById('cameraContainer').style.display='none';document.getElementById('controlsPanel').style.display='block';document.getElementById('opacityGroup').style.display='none';document.getElementById('zoomGroup').style.display='none';document.getElementById('captureBtn').style.display='none';document.getElementById('uploadModernGroup').style.display='block';ec.innerHTML='';let m=t('errors','cameraFail');if(err.name==='NotFoundError')m+=t('errors','notFound');else if(err.name==='NotReadableError')m+=t('errors','notReadable');else if(!isMobile)m+=t('errors','desktopUpload');showToast(m,'warning');}}
        document.getElementById('opacitySlider').addEventListener('input',function(e){document.getElementById('historical-overlay').style.opacity=e.target.value/100;document.getElementById('opacityValue').textContent=e.target.value+'%';});
        document.getElementById('zoomSlider').addEventListener('input',function(e){currentZoom=e.target.value/100;document.getElementById('video-feed').style.transform=`scale(${currentZoom})`;document.getElementById('zoomValue').textContent=currentZoom.toFixed(1)+'x';});
        function capturePhoto(){const v=document.getElementById('video-feed'),c=document.getElementById('snapshot-canvas'),hi=new Image();hi.src=historicalImage;hi.onload=function(){const tw=hi.naturalWidth,th=hi.naturalHeight,ta=tw/th;c.width=tw;c.height=th;const ctx=c.getContext('2d'),va=v.videoWidth/v.videoHeight;let sx,sy,sw,sh;if(va>ta){sh=v.videoHeight;sw=sh*ta;sx=(v.videoWidth-sw)/2;sy=0;}else{sw=v.videoWidth;sh=sw/ta;sx=0;sy=(v.videoHeight-sh)/2;}ctx.save();ctx.translate(tw/2,th/2);ctx.scale(currentZoom,currentZoom);ctx.translate(-tw/2,-th/2);ctx.drawImage(v,sx,sy,sw,sh,0,0,tw,th);ctx.restore();capturedImageData=c.toDataURL('image/jpeg',0.95);document.getElementById('captured-image').src=capturedImageData;document.getElementById('compareBtn').style.display='inline-flex';document.getElementById('saveBtn').style.display='inline-flex';if(navigator.vibrate)navigator.vibrate(50);showToast(t('toasts','photoCaptured'));};}
        function toggleComparison(){const sc=document.getElementById('sliderComparison'),vid=document.getElementById('video-feed'),ov=document.getElementById('historical-overlay'),ct=document.getElementById('compareBtnText'),ci=document.getElementById('compareBtnIcon'),og=document.getElementById('opacityGroup'),zg=document.getElementById('zoomGroup'),csg=document.getElementById('comparisonSliderGroup'),cap=document.getElementById('captureBtn'),rst=document.getElementById('resetBtn'),hint=document.getElementById('sliderHint'),pill=document.getElementById('statusPill'),vf=document.getElementById('viewfinder'),lang=document.documentElement.getAttribute('data-lang');if(sc.classList.contains('active')){isComparing=false;sc.classList.remove('active');vid.style.display='block';ov.style.display='block';ct.textContent=ct.getAttribute('data-'+lang);ci.className='fa-solid fa-repeat';og.style.display='block';zg.style.display='block';cap.style.display='inline-flex';rst.style.display='inline-flex';csg.style.display='none';hint.classList.remove('active');pill.classList.add('active');vf.style.display='block';}else{if(!capturedImageData){showToast(t('toasts','captureFirst'),'warning');return;}isComparing=true;document.getElementById('comparisonSlider').value=50;updateSliderComparison(50);sc.classList.add('active');vid.style.display='none';ov.style.display='none';ct.textContent=ct.getAttribute('data-'+lang+'-alt');ci.className='fa-solid fa-video';og.style.display='none';zg.style.display='none';cap.style.display='none';rst.style.display='none';csg.style.display='block';hint.classList.add('active');pill.classList.remove('active');vf.style.display='none';}}
        document.getElementById('comparisonSlider').addEventListener('input',function(e){updateSliderComparison(parseInt(e.target.value));});
        function updateSliderComparison(v){document.getElementById('sliderDivider').style.left=v+'%';document.getElementById('historical-comparison').style.clipPath=`inset(0 ${100-v}% 0 0)`;document.getElementById('captured-image').style.clipPath=`inset(0 0 0 ${v}%)`;}
        function saveComparison(){console.log('saveComparison called');console.log('historicalImage:',historicalImage?historicalImage.substring(0,50)+'...':'NULL');console.log('capturedImageData:',capturedImageData?capturedImageData.substring(0,50)+'...':'NULL');if(!capturedImageData){showToast(t('toasts','captureFirst'),'warning');return;}if(!historicalImage){showToast(t('toasts','captureFirst'),'warning');return;}const c=document.getElementById('snapshot-canvas'),ctx=c.getContext('2d'),i1=new Image(),i2=new Image();const st=getComputedStyle(document.documentElement),tc=st.getPropertyValue('--save-then').trim(),nc=st.getPropertyValue('--save-now').trim(),bg=st.getPropertyValue('--bg-primary').trim();i1.onload=function(){console.log('i1 (historical) loaded:',i1.width,'x',i1.height);i2.onload=function(){console.log('i2 (captured) loaded:',i2.width,'x',i2.height);const mw=Math.max(i1.width,i2.width),mh=Math.max(i1.height,i2.height);c.width=mw*2;c.height=mh;ctx.fillStyle=bg;ctx.fillRect(0,0,c.width,c.height);ctx.drawImage(i1,(mw-i1.width)/2,(mh-i1.height)/2);ctx.drawImage(i2,mw+(mw-i2.width)/2,(mh-i2.height)/2);const g=ctx.createLinearGradient(mw,0,mw,mh);g.addColorStop(0,'#6c5ce7');g.addColorStop(.5,'#a855f7');g.addColorStop(1,'#ec4899');ctx.strokeStyle=g;ctx.lineWidth=6;ctx.beginPath();ctx.moveTo(mw,0);ctx.lineTo(mw,mh);ctx.stroke();const fs=Math.max(32,mh/20);ctx.font=`bold ${fs}px sans-serif`;ctx.strokeStyle=bg;ctx.lineWidth=4;const p=30;ctx.fillStyle=tc;ctx.strokeText(t('save','then'),p,fs+p);ctx.fillText(t('save','then'),p,fs+p);ctx.fillStyle=nc;const nowX=mw+mw-p-ctx.measureText(t('save','now')).width;ctx.strokeText(t('save','now'),nowX,fs+p);ctx.fillText(t('save','now'),nowX,fs+p);console.log('Canvas saved, size:',c.width,'x',c.height);document.getElementById('download-link').href=c.toDataURL('image/jpeg',.95);document.getElementById('download-link').click();if(navigator.vibrate)navigator.vibrate([50,100,50]);showToast(t('toasts','saved'))};console.log('Loading i2 from capturedImageData');i2.src=capturedImageData};console.log('Loading i1 from historicalImage');i1.src=historicalImage}
        function resetApp(){if(confirm(t('toasts','confirmReset'))){if(stream)stream.getTracks().forEach(t=>t.stop());isComparing=false;historicalInputUsed=false;document.getElementById('uploadSection').classList.remove('active');document.getElementById('uploadSection').style.pointerEvents='';document.getElementById('cameraContainer').classList.remove('active');document.getElementById('controlsPanel').style.display='none';document.getElementById('compareBtn').style.display='none';document.getElementById('saveBtn').style.display='none';document.getElementById('sliderComparison').classList.remove('active');document.getElementById('captureBtn').style.display='inline-flex';document.getElementById('resetBtn').style.display='inline-flex';document.getElementById('errorContainer').innerHTML='';document.getElementById('sliderHint').classList.remove('active');document.getElementById('statusPill').classList.remove('active');document.getElementById('opacityGroup').style.display='block';document.getElementById('zoomGroup').style.display='block';document.getElementById('viewfinder').style.display='block';document.getElementById('uploadModernGroup').style.display='none';const lang=document.documentElement.getAttribute('data-lang'),ct=document.getElementById('compareBtnText');ct.textContent=ct.getAttribute('data-'+lang);historicalImage=null;capturedImageData=null;currentZoom=1;document.getElementById('opacitySlider').value=50;document.getElementById('opacityValue').textContent='50%';document.getElementById('zoomSlider').value=100;document.getElementById('zoomValue').textContent='1.0x';document.getElementById('historicalInput').value='';document.getElementById('modernInput').value='';document.getElementById('video-feed').style.transform='scale(1)';}}
        document.body.addEventListener('touchmove',function(e){if(e.target.closest('.camera-container'))e.preventDefault();},{passive:false});
        if('serviceWorker' in navigator){window.addEventListener('load',()=>{navigator.serviceWorker.register('sw.js').catch(()=>{});});}
    </script>
</body>
</html>
