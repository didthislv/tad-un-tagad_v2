<!DOCTYPE html>
<html lang="lv" data-theme="dark" data-lang="lv">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#6c5ce7">
<title>Tad un Tagad</title>
<link rel="manifest" href="manifest.json">
<link rel="icon" type="image/svg+xml" href="icon.svg">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
@import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600;700&family=Inter:wght@400;500;600&display=swap');
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
:root{--d-bg1:#0a0a0f;--d-bg2:#101018;--d-card:rgba(255,255,255,.03);--d-txt1:#e8e8ed;--d-txt2:#8888a0;--d-txt3:#55556a;--d-a1:#6c5ce7;--d-a2:#a855f7;--d-a3:#ec4899;--d-glow:rgba(108,92,231,.3);--d-brd:rgba(255,255,255,.06);--d-glass:rgba(255,255,255,.04);--d-track:rgba(255,255,255,.06);--d-ok-bg:rgba(34,197,94,.15);--d-ok-txt:#86efac;--d-ok-brd:rgba(34,197,94,.2);--d-warn-bg:rgba(234,179,8,.15);--d-warn-txt:#fde68a;--d-warn-brd:rgba(234,179,8,.2);--d-err-bg:rgba(239,68,68,.08);--d-err-brd:rgba(239,68,68,.2);--d-err-txt:#f87171;--d-danger-bg:rgba(239,68,68,.1);--d-danger-txt:#f87171;--d-danger-brd:rgba(239,68,68,.15);--d-status:rgba(0,0,0,.7);--d-pill:rgba(168,85,247,.1);--d-m1:rgba(108,92,231,.08);--d-m2:rgba(168,85,247,.06);--d-m3:rgba(236,72,153,.05);--d-then-bg:rgba(108,92,231,.3);--d-then-txt:#c4b5fd;--d-now-bg:rgba(236,72,153,.3);--d-now-txt:#f9a8d4;--d-vf:rgba(108,92,231,.5);--d-thumb:rgba(255,255,255,.2);--d-save-then:#c4b5fd;--d-save-now:#f9a8d4;--d-modal:rgba(10,10,15,.95);--l-bg1:#f5f5f7;--l-bg2:#eeeef0;--l-card:rgba(0,0,0,.02);--l-txt1:#1a1a2e;--l-txt2:#6b6b80;--l-txt3:#9999aa;--l-a1:#6c5ce7;--l-a2:#9333ea;--l-a3:#db2777;--l-glow:rgba(108,92,231,.2);--l-brd:rgba(0,0,0,.08);--l-glass:rgba(0,0,0,.03);--l-track:rgba(0,0,0,.08);--l-ok-bg:rgba(34,197,94,.12);--l-ok-txt:#15803d;--l-ok-brd:rgba(34,197,94,.25);--l-warn-bg:rgba(234,179,8,.12);--l-warn-txt:#a16207;--l-warn-brd:rgba(234,179,8,.25);--l-err-bg:rgba(239,68,68,.06);--l-err-brd:rgba(239,68,68,.2);--l-err-txt:#dc2626;--l-danger-bg:rgba(239,68,68,.08);--l-danger-txt:#dc2626;--l-danger-brd:rgba(239,68,68,.18);--l-status:rgba(255,255,255,.85);--l-pill:rgba(147,51,234,.1);--l-m1:rgba(108,92,231,.05);--l-m2:rgba(147,51,234,.04);--l-m3:rgba(219,39,119,.03);--l-then-bg:rgba(108,92,231,.15);--l-then-txt:#5b21b6;--l-now-bg:rgba(219,39,119,.15);--l-now-txt:#9d174d;--l-vf:rgba(108,92,231,.4);--l-thumb:rgba(255,255,255,.6);--l-save-then:#6c5ce7;--l-save-now:#db2777;--l-modal:rgba(245,245,247,.97)}
[data-theme=dark]{--bg1:var(--d-bg1);--bg2:var(--d-bg2);--card:var(--d-card);--txt1:var(--d-txt1);--txt2:var(--d-txt2);--txt3:var(--d-txt3);--a1:var(--d-a1);--a2:var(--d-a2);--a3:var(--d-a3);--glow:var(--d-glow);--brd:var(--d-brd);--glass:var(--d-glass);--track:var(--d-track);--ok-bg:var(--d-ok-bg);--ok-txt:var(--d-ok-txt);--ok-brd:var(--d-ok-brd);--warn-bg:var(--d-warn-bg);--warn-txt:var(--d-warn-txt);--warn-brd:var(--d-warn-brd);--err-bg:var(--d-err-bg);--err-brd:var(--d-err-brd);--err-txt:var(--d-err-txt);--danger-bg:var(--d-danger-bg);--danger-txt:var(--d-danger-txt);--danger-brd:var(--d-danger-brd);--status:var(--d-status);--pill:var(--d-pill);--m1:var(--d-m1);--m2:var(--d-m2);--m3:var(--d-m3);--then-bg:var(--d-then-bg);--then-txt:var(--d-then-txt);--now-bg:var(--d-now-bg);--now-txt:var(--d-now-txt);--vf:var(--d-vf);--thumb:var(--d-thumb);--save-then:var(--d-save-then);--save-now:var(--d-save-now);--modal:var(--d-modal)}
[data-theme=light]{--bg1:var(--l-bg1);--bg2:var(--l-bg2);--card:var(--l-card);--txt1:var(--l-txt1);--txt2:var(--l-txt2);--txt3:var(--l-txt3);--a1:var(--l-a1);--a2:var(--l-a2);--a3:var(--l-a3);--glow:var(--l-glow);--brd:var(--l-brd);--glass:var(--l-glass);--track:var(--l-track);--ok-bg:var(--l-ok-bg);--ok-txt:var(--l-ok-txt);--ok-brd:var(--l-ok-brd);--warn-bg:var(--l-warn-bg);--warn-txt:var(--l-warn-txt);--warn-brd:var(--l-warn-brd);--err-bg:var(--l-err-bg);--err-brd:var(--l-err-brd);--err-txt:var(--l-err-txt);--danger-bg:var(--l-danger-bg);--danger-txt:var(--l-danger-txt);--danger-brd:var(--l-danger-brd);--status:var(--l-status);--pill:var(--l-pill);--m1:var(--l-m1);--m2:var(--l-m2);--m3:var(--l-m3);--then-bg:var(--l-then-bg);--then-txt:var(--l-then-txt);--now-bg:var(--l-now-bg);--now-txt:var(--l-now-txt);--vf:var(--l-vf);--thumb:var(--l-thumb);--save-then:var(--l-save-then);--save-now:var(--l-save-now);--modal:var(--l-modal)}
body{font-family:Inter,sans-serif;background:var(--bg1);color:var(--txt1);min-height:100vh;overflow:hidden;position:fixed;width:100%;height:100%;transition:background .4s,color .4s}
.bg-mesh{position:fixed;inset:0;pointer-events:none;z-index:0;overflow:hidden}
.bg-mesh::before{content:'';position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:radial-gradient(ellipse at 20% 50%,var(--m1) 0%,transparent 50%),radial-gradient(ellipse at 80% 20%,var(--m2) 0%,transparent 50%),radial-gradient(ellipse at 50% 80%,var(--m3) 0%,transparent 50%);animation:meshMove 20s ease-in-out infinite alternate}
@keyframes meshMove{to{transform:translate(-5%,-3%) rotate(3deg)}}
.container{position:relative;z-index:1;width:100%;height:100vh;height:100dvh;display:flex;flex-direction:column;overflow:hidden}
header{text-align:center;padding:8px 16px 4px;flex-shrink:0;display:flex;align-items:center;justify-content:center;position:relative}
.logo-row{display:flex;align-items:center;gap:10px;margin-bottom:1px}
.logo-icon{width:30px;height:30px;filter:drop-shadow(0 2px 8px var(--glow))}
h1{font-family:'Space Grotesk',sans-serif;font-size:clamp(1.1rem,4vw,1.5rem);font-weight:700;letter-spacing:-.02em;background:linear-gradient(135deg,var(--txt1),var(--txt2));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.subtitle{font-size:.65rem;color:var(--txt3);letter-spacing:.05em}
.header-toggle{position:absolute;top:50%;transform:translateY(-50%);height:22px;border-radius:50px;background:var(--glass);border:1px solid var(--brd);cursor:pointer;display:flex;align-items:center;padding:2px;transition:all .4s cubic-bezier(.4,0,.2,1);touch-action:manipulation}
.header-toggle:active{transform:translateY(-50%) scale(.92)}
.toggle-knob{width:16px;height:16px;border-radius:50%;background:linear-gradient(135deg,var(--a1),var(--a2));display:flex;align-items:center;justify-content:center;transition:all .4s cubic-bezier(.4,0,.2,1);box-shadow:0 2px 8px var(--glow)}
.toggle-knob i{font-size:8px;color:#fff}
.lang-toggle{left:16px;width:48px}
.lang-toggle .toggle-knob{font-family:'Space Grotesk',sans-serif;font-size:7px;font-weight:700;letter-spacing:.03em;color:#fff}
[data-lang=en] .lang-toggle .toggle-knob{transform:translateX(26px)}
.lang-label{position:absolute;top:50%;transform:translateY(-50%);font-family:'Space Grotesk',sans-serif;font-size:6.5px;font-weight:600;color:var(--txt3);pointer-events:none;letter-spacing:.02em;transition:opacity .3s}
.lang-label.left{left:6px}
.lang-label.right{right:6px}
[data-lang=lv] .lang-label.left,[data-lang=en] .lang-label.right{opacity:0}
.theme-toggle{right:16px;width:40px}
[data-theme=light] .theme-toggle .toggle-knob{transform:translateX(18px)}
.upload-section{background:var(--card);backdrop-filter:blur(20px);border:1px solid var(--brd);border-radius:16px;padding:40px 24px;margin:16px;text-align:center;transition:all .4s cubic-bezier(.4,0,.2,1);cursor:pointer;position:relative;overflow:hidden;flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center}
.upload-section::before{content:'';position:absolute;inset:0;border-radius:16px;padding:1px;background:linear-gradient(135deg,rgba(108,92,231,.3),transparent,rgba(168,85,247,.2));-webkit-mask:linear-gradient(#fff 0 0) content-box,linear-gradient(#fff 0 0);-webkit-mask-composite:xor;mask-composite:exclude;opacity:0;transition:opacity .4s}
.upload-section:hover::before,.upload-section:active::before{opacity:1}
.upload-section:active{transform:scale(.98)}
.upload-section.active{display:none}
.upload-icon-wrapper{width:120px;height:100px;display:flex;align-items:center;justify-content:center;margin:0 auto 20px;animation:breathe 4s ease-in-out infinite;filter:drop-shadow(0 4px 20px var(--glow))}
@keyframes breathe{50%{transform:scale(1.05)}}
.upload-section h2{font-family:'Space Grotesk',sans-serif;font-size:1rem;font-weight:600;margin-bottom:8px}
.upload-hint{font-size:.73rem;color:var(--txt3);display:flex;align-items:center;gap:6px;justify-content:center}
.upload-hint i{font-size:.65rem;color:var(--a1)}
input[type=file]{display:none}
.btn{font-family:'Space Grotesk',sans-serif;border:none;padding:9px 16px;border-radius:50px;font-size:.75rem;font-weight:600;cursor:pointer;transition:all .3s cubic-bezier(.4,0,.2,1);touch-action:manipulation;display:inline-flex;align-items:center;gap:6px}
.btn i{font-size:.8rem}
.btn-primary{background:linear-gradient(135deg,var(--a1),var(--a2));color:#fff;box-shadow:0 4px 15px var(--glow)}
.btn-primary:active{transform:scale(.96)}
.btn-ghost{background:var(--glass);color:var(--txt1);border:1px solid var(--brd)}
.btn-ghost:active{transform:scale(.96)}
.btn-danger{background:var(--danger-bg);color:var(--danger-txt);border:1px solid var(--danger-brd)}
.btn-danger:active{transform:scale(.96)}
.camera-container{display:none;position:relative;flex:1;min-height:0;margin:0 8px;border-radius:14px;overflow:hidden;border:1px solid var(--brd);background:#000}
.camera-container.active{display:block}
#video-feed{width:100%;height:100%;display:block;background:#000;transform-origin:center;object-fit:cover}
#historical-overlay{position:absolute;inset:0;object-fit:contain;pointer-events:none;transition:opacity .3s}
.viewfinder{position:absolute;inset:12px;pointer-events:none;z-index:3}
.vf-corner{position:absolute;width:20px;height:20px;border-color:var(--vf);border-style:solid;border-width:0}
.vf-corner.tl{top:0;left:0;border-top-width:2px;border-left-width:2px;border-radius:3px 0 0 0}
.vf-corner.tr{top:0;right:0;border-top-width:2px;border-right-width:2px;border-radius:0 3px 0 0}
.vf-corner.bl{bottom:0;left:0;border-bottom-width:2px;border-left-width:2px;border-radius:0 0 0 3px}
.vf-corner.br{bottom:0;right:0;border-bottom-width:2px;border-right-width:2px;border-radius:0 0 3px 0}
.status-pill{display:none;position:absolute;bottom:8px;left:50%;transform:translateX(-50%);padding:4px 12px;border-radius:20px;font-family:'Space Grotesk',sans-serif;font-size:.6rem;font-weight:500;background:var(--status);backdrop-filter:blur(10px);border:1px solid var(--brd);color:var(--txt2);z-index:4}
.status-pill.active{display:block;animation:fadeInUp .4s}
.status-pill .dot{display:inline-block;width:5px;height:5px;border-radius:50%;background:#22c55e;margin-right:5px;animation:blink 2s ease-in-out infinite}
@keyframes blink{50%{opacity:.3}}
@keyframes fadeInUp{from{opacity:0;transform:translateX(-50%) translateY(10px)}}
.controls-panel{background:var(--bg2);border-top:1px solid var(--brd);padding:8px 12px 6px;flex-shrink:0;transition:background .4s}
.control-group{margin-bottom:6px}
.control-group:last-child{margin-bottom:0}
.control-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:4px}
.control-label{font-family:'Space Grotesk',sans-serif;font-size:.68rem;font-weight:500;color:var(--txt2)}
.control-label i{margin-right:5px}
.control-value{font-family:'Space Grotesk',sans-serif;font-size:.65rem;font-weight:600;color:var(--a2);background:var(--pill);padding:1px 7px;border-radius:20px}
input[type=range]{width:100%;height:3px;border-radius:3px;background:var(--track);outline:0;-webkit-appearance:none}
input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:16px;height:16px;border-radius:50%;background:linear-gradient(135deg,var(--a1),var(--a2));cursor:pointer;box-shadow:0 0 8px var(--glow);border:2px solid var(--thumb)}
input[type=range]::-webkit-slider-thumb:active{transform:scale(1.3)}
input[type=range]::-moz-range-thumb{width:16px;height:16px;border-radius:50%;background:linear-gradient(135deg,var(--a1),var(--a2));cursor:pointer;border:2px solid var(--thumb)}
.slider-comparison{position:absolute;inset:0;overflow:hidden;display:none;background:#000;z-index:10}
.slider-comparison.active{display:block}
#captured-image,#historical-comparison{position:absolute;inset:0;object-fit:contain}
#historical-comparison{clip-path:inset(0 50% 0 0);z-index:2}
#captured-image{z-index:1}
.slider-divider{position:absolute;top:0;left:50%;width:2px;height:100%;background:linear-gradient(180deg,var(--a1),var(--a2),var(--a3));transform:translateX(-50%);box-shadow:0 0 12px var(--glow);pointer-events:none;z-index:5}
.comparison-labels{position:absolute;top:10px;left:0;right:0;display:flex;justify-content:space-between;padding:0 12px;pointer-events:none;z-index:6}
.comp-label{font-family:'Space Grotesk',sans-serif;font-size:.6rem;font-weight:600;text-transform:uppercase;letter-spacing:.1em;padding:3px 10px;border-radius:20px;backdrop-filter:blur(10px)}
.comp-label.then{background:var(--then-bg);color:var(--then-txt);border:1px solid var(--then-bg)}
.comp-label.now{background:var(--now-bg);color:var(--now-txt);border:1px solid var(--now-bg)}
.comparison-slider{width:100%;height:6px;border-radius:6px;background:var(--track);outline:0;-webkit-appearance:none}
.comparison-slider::-webkit-slider-thumb{-webkit-appearance:none;width:40px;height:40px;border-radius:50%;background:linear-gradient(135deg,var(--a1),var(--a2));cursor:pointer;box-shadow:0 0 20px var(--glow),0 4px 12px rgba(0,0,0,.3);border:3px solid var(--thumb)}
.comparison-slider::-moz-range-thumb{width:40px;height:40px;border-radius:50%;background:linear-gradient(135deg,var(--a1),var(--a2));cursor:pointer;border:3px solid var(--thumb)}
.action-buttons{display:flex;gap:6px;justify-content:center;flex-wrap:wrap}
.slider-hint{display:none;text-align:center;margin-top:6px;font-size:.63rem;color:var(--txt3);animation:hintPulse 2.5s ease-in-out infinite}
.slider-hint.active{display:flex;align-items:center;justify-content:center;gap:8px}
.slider-hint i{font-size:.55rem;color:var(--a2)}
@keyframes hintPulse{50%{opacity:1}}
.app-footer{text-align:center;padding:4px 10px;flex-shrink:0;font-family:'Space Grotesk',sans-serif;font-size:.55rem;letter-spacing:.08em;color:var(--txt3);display:flex;align-items:center;justify-content:center;position:relative}
.info-btn{position:absolute;right:15px;top:20%;transform:translateY(-50%);width:22px;height:22px;border-radius:50%;background:var(--glass);border:1px solid var(--brd);color:var(--a1);font-size:11px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .3s;touch-action:manipulation}
.info-btn:hover{background:rgba(108,92,231,.15);border-color:var(--a1)}
.info-btn:active{transform:translateY(-50%) scale(.9)}
.info-modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.6);backdrop-filter:blur(8px);z-index:9998;display:none;align-items:center;justify-content:center;padding:20px;animation:modalFadeIn .3s}
.info-modal-overlay.active{display:flex}
@keyframes modalFadeIn{from{opacity:0}}
.info-modal{background:var(--modal);border:1px solid var(--brd);border-radius:20px;width:100%;max-width:400px;max-height:80vh;overflow-y:auto;padding:24px;position:relative;animation:modalSlideUp .4s cubic-bezier(.4,0,.2,1)}
@keyframes modalSlideUp{from{opacity:0;transform:translateY(30px)}}
.info-modal::-webkit-scrollbar{width:4px}
.info-modal::-webkit-scrollbar-track{background:0 0}
.info-modal::-webkit-scrollbar-thumb{background:var(--a1);border-radius:4px}
.info-close{position:absolute;top:16px;right:16px;width:28px;height:28px;border-radius:50%;background:var(--glass);border:1px solid var(--brd);color:var(--txt2);font-size:14px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .3s}
.info-close:hover{background:rgba(239,68,68,.15);color:var(--err-txt);border-color:rgba(239,68,68,.3)}
.info-modal-logo{width:60px;height:50px;margin:0 auto 12px;filter:drop-shadow(0 4px 15px var(--glow))}
.info-modal h2{font-family:'Space Grotesk',sans-serif;font-size:1.1rem;font-weight:700;text-align:center;margin-bottom:4px;background:linear-gradient(135deg,var(--a1),var(--a2));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.info-modal .info-subtitle{text-align:center;font-size:.7rem;color:var(--txt3);margin-bottom:16px}
.info-section{margin-bottom:14px}
.info-section h3{font-family:'Space Grotesk',sans-serif;font-size:.75rem;font-weight:600;color:var(--a2);margin-bottom:6px;display:flex;align-items:center;gap:6px}
.info-section h3 i{font-size:.7rem}
.info-section p,.info-section li{font-size:.7rem;line-height:1.6;color:var(--txt2)}
.info-section ul{list-style:none;padding:0}
.info-section li{padding:3px 0 3px 16px;position:relative}
.info-section li::before{content:'';position:absolute;left:0;top:10px;width:6px;height:6px;border-radius:50%;background:linear-gradient(135deg,var(--a1),var(--a2))}
.info-version{text-align:center;font-family:'Space Grotesk',sans-serif;font-size:.6rem;color:var(--txt3);margin-top:16px;padding-top:12px;border-top:1px solid var(--brd)}
.toast{position:fixed;top:16px;left:50%;transform:translateX(-50%) translateY(-100px);padding:10px 20px;border-radius:50px;font-family:'Space Grotesk',sans-serif;font-size:.75rem;font-weight:500;z-index:10000;backdrop-filter:blur(20px);transition:transform .5s cubic-bezier(.4,0,.2,1);display:flex;align-items:center;gap:8px;white-space:nowrap}
.toast.show{transform:translateX(-50%) translateY(0)}
.toast.success{background:var(--ok-bg);color:var(--ok-txt);border:1px solid var(--ok-brd)}
.toast.warning{background:var(--warn-bg);color:var(--warn-txt);border:1px solid var(--warn-brd)}
.toast i{font-size:.9rem}
.error-message{background:var(--err-bg);border:1px solid var(--err-brd);border-radius:10px;padding:14px 18px;margin:10px 16px;text-align:center}
.error-message h3{font-family:'Space Grotesk',sans-serif;margin-bottom:4px;color:var(--err-txt);font-size:.85rem}
.error-message p{font-size:.75rem;color:var(--txt2)}
.loading{text-align:center;padding:16px;font-family:'Space Grotesk',sans-serif;color:var(--a2);font-size:.8rem;display:flex;align-items:center;justify-content:center;gap:8px}
.loading-dots{display:inline-flex;gap:3px}
.loading-dots span{width:4px;height:4px;border-radius:50%;background:var(--a2);animation:loadDot 1.4s ease-in-out infinite}
.loading-dots span:nth-child(2){animation-delay:.2s}
.loading-dots span:nth-child(3){animation-delay:.4s}
@keyframes loadDot{0%,80%,100%{opacity:.2;transform:scale(.8)}40%{opacity:1;transform:scale(1.2)}}
canvas,#download-link{display:none}
@media(max-width:768px){.action-buttons{flex-direction:column}.btn{width:100%;justify-content:center}}
.camera-container,.controls-panel{animation:slideUp .5s cubic-bezier(.4,0,.2,1)}
@keyframes slideUp{from{opacity:0;transform:translateY(20px)}}
</style>
</head>
<body>
<div class="bg-mesh"></div>
<div class="toast" id="toast"><i id="toastIcon"></i><span id="toastText"></span></div>
<div class="info-modal-overlay" id="infoModal" onclick="event.target===this&&closeInfo()">
<div class="info-modal">
<button class="info-close" onclick="closeInfo()"><i class="fa-solid fa-xmark"></i></button>
<div class="info-modal-logo"><svg viewBox="80 185 452 490"><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m220.478 429.458c0 47.264 38.365 85.629 85.629 85.629s85.629-38.365 85.629-85.629M163.392 429.458c0 78.774 63.936 142.715 142.715 142.715 32.116 0 61.765-10.627 85.619-28.553M220.478 429.458V248.684M163.392 429.458V248.684M391.736 315.286V248.684M448.822 429.458V248.684M163.392 248.684H87.274M87.274 248.684v-57.086M87.274 191.598h209.317M296.591 248.684h-76.113M391.736 248.684h-76.118M315.618 248.684v-57.086M296.591 248.684v-57.086M315.618 191.598h209.317M524.935 191.598v57.086M524.935 248.684h-76.113M306.107 515.087c47.264 0 85.629-38.365 85.629-85.629s-38.365-85.629-85.629-85.629c-43.44 0-85.629 38.365-85.629 85.629M448.822 429.458c0-78.774-63.941-142.715-142.715-142.715-32.116 0-61.765 10.627-85.624 28.553M220.478 543.63v66.597M163.392 429.458v180.769M391.736 429.458v180.769M448.822 429.458v180.769M163.392 610.227H87.274M87.274 610.227v57.086M87.274 667.313h209.317M296.591 610.227h-76.113M391.736 610.227h-76.118M315.618 610.227v57.086M296.591 610.227v57.086M315.618 667.313h209.317M524.935 667.313v-57.086M524.935 610.227h-76.113M306.107 286.743v57.086M306.107 515.087v57.086"/><path fill="#6c5ce7" stroke="#6c5ce7" stroke-width="3.36" d="m281.937 567.365c-18.693-3.298-39.337-11.862-55.874-23.176-10.335-7.072-27.732-24.506-34.916-34.991-8.344-12.179-16.814-30.622-20.73-45.14l-3.399-12.6-.313-101.571c-.22-71.234-.659-101.988-1.472-102.967-.915-1.103-8.949-1.396-38.277-1.396H89.839v-51.084h204.338v51.084h-37.119c-30.522 0-37.338.265-38.355 1.49-.925 1.115-1.153 25.992-.904 98.71.332 97.089.336 97.231 2.727 105.734 10.136 36.043 37.497 60.074 74.57 65.495l8.659 1.266v50.84l-6.652-.096c-3.658-.053-10.483-.772-15.166-1.598z"/><path fill="#6c5ce7" stroke="#6c5ce7" stroke-width="2.21" d="M318.654 638.767v-26.074h75.562v-96.36c0-83.766-.221-97.432-1.686-104.563-7.673-37.337-38.947-65.842-76.803-70.006l-6.652-.732v-51.98l6.652.663c3.658.364 10.662 1.373 15.564 2.24 53.265 9.431 96.881 50.153 110.277 102.96 4.487 17.686 4.797 25.72 4.797 124.08v93.697h75.562v52.148H318.654z"/></svg></div>
<h2 data-lv="Tad un Tagad" data-en="Then and Now">Tad un Tagad</h2>
<p class="info-subtitle" data-lv="Vēsturisko un mūsdienu foto salīdzināšana" data-en="Historical and modern photo comparison">Vēsturisko un mūsdienu foto salīdzināšana</p>
<div class="info-section"><h3><i class="fa-solid fa-bullseye"></i><span data-lv="Kā lietot" data-en="How to use">Kā lietot</span></h3><ul><li data-lv="Augšupielādē vēsturisko fotoattēlu" data-en="Upload a historical photo">Augšupielādē vēsturisko fotoattēlu</li><li data-lv="Atļauj kameras piekļuvi" data-en="Allow camera access">Atļauj kameras piekļuvi</li><li data-lv="Regulē caurspīdīgumu un tālummaiņu" data-en="Adjust opacity and zoom">Regulē caurspīdīgumu un tālummaiņu</li><li data-lv="Uzņem foto, kad skats sakrīt" data-en="Capture when aligned">Uzņem foto, kad skats sakrīt</li><li data-lv="Izmanto slīdni, lai salīdzinātu" data-en="Use slider to compare">Izmanto slīdni, lai salīdzinātu</li><li data-lv="Saglabā rezultātu" data-en="Save the result">Saglabā rezultātu</li></ul></div>
<div class="info-section"><h3><i class="fa-solid fa-star"></i><span data-lv="Funkcijas" data-en="Features">Funkcijas</span></h3><ul><li data-lv="Reāllaika kameras overlay" data-en="Real-time camera overlay">Reāllaika kameras overlay</li><li data-lv="Caurspīdīguma kontrole (0-100%)" data-en="Opacity control (0-100%)">Caurspīdīguma kontrole (0-100%)</li><li data-lv="Digitālā tālummaiņa (1x-3x)" data-en="Digital zoom (1x-3x)">Digitālā tālummaiņa (1x-3x)</li><li data-lv="Interaktīvs salīdzināšanas slaideris" data-en="Interactive comparison slider">Interaktīvs salīdzināšanas slaideris</li><li data-lv="Salīdzinājuma saglabāšana (JPG)" data-en="Save comparison (JPG)">Salīdzinājuma saglabāšana (JPG)</li><li data-lv="Gaišā / tumšā tēma" data-en="Light / dark theme">Gaišā / tumšā tēma</li><li data-lv="Latviešu un angļu valoda" data-en="Latvian and English language">Latviešu un angļu valoda</li><li data-lv="Darbojas offline (PWA)" data-en="Works offline (PWA)">Darbojas offline (PWA)</li></ul></div>
<div class="info-section"><h3><i class="fa-solid fa-circle-info"></i><span data-lv="Prasības" data-en="Requirements">Prasības</span></h3><ul><li data-lv="HTTPS savienojums kameras piekļuvei" data-en="HTTPS connection for camera access">HTTPS savienojums kameras piekļuvei</li><li data-lv="Moderna pārlūkprogramma" data-en="Modern web browser">Moderna pārlūkprogramma</li><li data-lv="Ierīce ar kameru" data-en="Device with camera">Ierīce ar kameru</li></ul></div>
<div class="info-version">© DS 2025 v3</div>
</div>
</div>
<div class="container">
<header>
<div class="header-toggle lang-toggle" onclick="toggleLang()"><span class="lang-label left">LV</span><div class="toggle-knob" id="langKnob">LV</div><span class="lang-label right">EN</span></div>
<div class="header-content"><div class="logo-row"><div class="logo-icon"><svg viewBox="80 185 452 490"><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m220.478 429.458c0 47.264 38.365 85.629 85.629 85.629s85.629-38.365 85.629-85.629M163.392 429.458c0 78.774 63.936 142.715 142.715 142.715 32.116 0 61.765-10.627 85.619-28.553M220.478 429.458V248.684M163.392 429.458V248.684M391.736 315.286V248.684M448.822 429.458V248.684M163.392 248.684H87.274M87.274 248.684v-57.086M87.274 191.598h209.317M296.591 248.684h-76.113M391.736 248.684h-76.118M315.618 248.684v-57.086M296.591 248.684v-57.086M315.618 191.598h209.317M524.935 191.598v57.086M524.935 248.684h-76.113M306.107 515.087c47.264 0 85.629-38.365 85.629-85.629s-38.365-85.629-85.629-85.629c-43.44 0-85.629 38.365-85.629 85.629M448.822 429.458c0-78.774-63.941-142.715-142.715-142.715-32.116 0-61.765 10.627-85.624 28.553M220.478 543.63v66.597M163.392 429.458v180.769M391.736 429.458v180.769M448.822 429.458v180.769M163.392 610.227H87.274M87.274 610.227v57.086M87.274 667.313h209.317M296.591 610.227h-76.113M391.736 610.227h-76.118M315.618 610.227v57.086M296.591 610.227v57.086M315.618 667.313h209.317M524.935 667.313v-57.086M524.935 610.227h-76.113M306.107 286.743v57.086M306.107 515.087v57.086"/><path fill="#6c5ce7" stroke="#6c5ce7" stroke-width="3.36" d="m281.937 567.365c-18.693-3.298-39.337-11.862-55.874-23.176-10.335-7.072-27.732-24.506-34.916-34.991-8.344-12.179-16.814-30.622-20.73-45.14l-3.399-12.6-.313-101.571c-.22-71.234-.659-101.988-1.472-102.967-.915-1.103-8.949-1.396-38.277-1.396H89.839v-51.084h204.338v51.084h-37.119c-30.522 0-37.338.265-38.355 1.49-.925 1.115-1.153 25.992-.904 98.71.332 97.089.336 97.231 2.727 105.734 10.136 36.043 37.497 60.074 74.57 65.495l8.659 1.266v50.84l-6.652-.096c-3.658-.053-10.483-.772-15.166-1.598z"/><path fill="#6c5ce7" stroke="#6c5ce7" stroke-width="2.21" d="M318.654 638.767v-26.074h75.562v-96.36c0-83.766-.221-97.432-1.686-104.563-7.673-37.337-38.947-65.842-76.803-70.006l-6.652-.732v-51.98l6.652.663c3.658.364 10.662 1.373 15.564 2.24 53.265 9.431 96.881 50.153 110.277 102.96 4.487 17.686 4.797 25.72 4.797 124.08v93.697h75.562v52.148H318.654z"/></svg></div><h1 data-lv="Tad un Tagad" data-en="Then and Now">Tad un Tagad</h1></div><p class="subtitle" data-lv="Salīdzini vēsturi ar tagadni" data-en="Compare history with the present">Salīdzini vēsturi ar tagadni</p></div>
<div class="header-toggle theme-toggle" onclick="toggleTheme()"><div class="toggle-knob"><i class="fa-solid fa-moon" id="themeIcon"></i></div></div>
</header>
<div class="upload-section" id="uploadSection" onclick="document.getElementById('historicalInput').click()">
<div class="upload-icon-wrapper"><svg viewBox="80 185 452 490"><path fill="none" stroke="#6c5ce7" stroke-width="4.33" stroke-linecap="round" stroke-linejoin="round" d="m220.478 429.458c0 47.264 38.365 85.629 85.629 85.629s85.629-38.365 85.629-85.629M163.392 429.458c0 78.774 63.936 142.715 142.715 142.715 32.116 0 61.765-10.627 85.619-28.553M220.478 429.458V248.684M163.392 429.458V248.684M391.736 315.286V248.684M448.822 429.458V248.684M163.392 248.684H87.274M87.274 248.684v-57.086M87.274 191.598h209.317M296.591 248.684h-76.113M391.736 248.684h-76.118M315.618 248.684v-57.086M296.591 248.684v-57.086M315.618 191.598h209.317M524.935 191.598v57.086M524.935 248.684h-76.113M306.107 515.087c47.264 0 85.629-38.365 85.629-85.629s-38.365-85.629-85.629-85.629c-43.44 0-85.629 38.365-85.629 85.629M448.822 429.458c0-78.774-63.941-142.715-142.715-142.715-32.116 0-61.765 10.627-85.624 28.553M220.478 543.63v66.597M163.392 429.458v180.769M391.736 429.458v180.769M448.822 429.458v180.769M163.392 610.227H87.274M87.274 610.227v57.086M87.274 667.313h209.317M296.591 610.227h-76.113M391.736 610.227h-76.118M315.618 610.227v57.086M296.591 610.227v57.086M315.618 667.313h209.317M524.935 667.313v-57.086M524.935 610.227h-76.113M306.107 286.743v57.086M306.107 515.087v57.086"/><path fill="#6c5ce7" stroke="#6c5ce7" stroke-width="3.36" d="m281.937 567.365c-18.693-3.298-39.337-11.862-55.874-23.176-10.335-7.072-27.732-24.506-34.916-34.991-8.344-12.179-16.814-30.622-20.73-45.14l-3.399-12.6-.313-101.571c-.22-71.234-.659-101.988-1.472-102.967-.915-1.103-8.949-1.396-38.277-1.396H89.839v-51.084h204.338v51.084h-37.119c-30.522 0-37.338.265-38.355 1.49-.925 1.115-1.153 25.992-.904 98.71.332 97.089.336 97.231 2.727 105.734 10.136 36.043 37.497 60.074 74.57 65.495l8.659 1.266v50.84l-6.652-.096c-3.658-.053-10.483-.772-15.166-1.598z"/><path fill="#6c5ce7" stroke="#6c5ce7" stroke-width="2.21" d="M318.654 638.767v-26.074h75.562v-96.36c0-83.766-.221-97.432-1.686-104.563-7.673-37.337-38.947-65.842-76.803-70.006l-6.652-.732v-51.98l6.652.663c3.658.364 10.662 1.373 15.564 2.24 53.265 9.431 96.881 50.153 110.277 102.96 4.487 17.686 4.797 25.72 4.797 124.08v93.697h75.562v52.148H318.654z"/></svg></div>
<h2 data-lv="Augšupielādē vēsturisko attēlu" data-en="Upload historical photo">Augšupielādē vēsturisko attēlu</h2>
<p class="upload-hint"><i class="fa-solid fa-hand-pointer"></i><span data-lv="Noklikšķini šeit, lai izvēlētos attēlu" data-en="Tap here to choose a photo">Noklikšķini šeit, lai izvēlētos attēlu</span></p>
<input type="file" id="historicalInput" accept="image/*">
</div>
<div id="errorContainer"></div>
<div class="camera-container" id="cameraContainer">
<video id="video-feed" autoplay playsinline muted></video>
<img id="historical-overlay" alt="">
<canvas id="snapshot-canvas"></canvas>
<div class="viewfinder" id="viewfinder"><div class="vf-corner tl"></div><div class="vf-corner tr"></div><div class="vf-corner bl"></div><div class="vf-corner br"></div></div>
<div class="status-pill" id="statusPill"><span class="dot"></span><span data-lv="Kamera aktīva" data-en="Camera active">Kamera aktīva</span></div>
<div class="slider-comparison" id="sliderComparison"><img id="captured-image" alt=""><img id="historical-comparison" alt=""><div class="slider-divider" id="sliderDivider"></div><div class="comparison-labels"><span class="comp-label then" data-lv="Tad" data-en="Then">Tad</span><span class="comp-label now" data-lv="Tagad" data-en="Now">Tagad</span></div></div>
</div>
<div class="controls-panel" id="controlsPanel" style="display:none">
<div class="control-group" id="opacityGroup"><div class="control-header"><span class="control-label"><i class="fa-solid fa-eye" style="color:var(--a1)"></i><span data-lv="Caurspīdīgums" data-en="Opacity">Caurspīdīgums</span></span><span class="control-value" id="opacityValue">50%</span></div><input type="range" id="opacitySlider" min="0" max="100" value="50"></div>
<div class="control-group" id="zoomGroup"><div class="control-header"><span class="control-label"><i class="fa-solid fa-magnifying-glass-plus" style="color:var(--a2)"></i><span data-lv="Tālummaiņa" data-en="Zoom">Tālummaiņa</span></span><span class="control-value" id="zoomValue">1.0x</span></div><input type="range" id="zoomSlider" min="100" max="300" value="100"></div>
<div class="action-buttons">
<button class="btn btn-primary" id="captureBtn" onclick="capturePhoto()"><i class="fa-solid fa-camera"></i><span data-lv="Uzņemt foto" data-en="Capture photo">Uzņemt foto</span></button>
<button class="btn btn-ghost" id="compareBtn" style="display:none" onclick="toggleComparison()"><i class="fa-solid fa-repeat" id="compareBtnIcon"></i><span id="compareBtnText" data-lv="Salīdzināt" data-en="Compare" data-lv-alt="Atpakaļ" data-en-alt="Back">Salīdzināt</span></button>
<button class="btn btn-ghost" id="saveBtn" style="display:none" onclick="saveComparison()"><i class="fa-solid fa-floppy-disk"></i><span data-lv="Saglabāt" data-en="Save">Saglabāt</span></button>
<button class="btn btn-danger" id="resetBtn" onclick="resetApp()"><i class="fa-solid fa-rotate-left"></i><span data-lv="Sākt no jauna" data-en="Start over">Sākt no jauna</span></button>
</div>
<div class="control-group" id="comparisonSliderGroup" style="display:none;padding-top:15px"><input type="range" class="comparison-slider" id="comparisonSlider" min="0" max="100" value="50"><div class="slider-hint" id="sliderHint"><i class="fa-solid fa-arrow-left"></i><span data-lv="velc aplīti, lai salīdzinātu" data-en="drag to compare">velc aplīti, lai salīdzinātu</span><i class="fa-solid fa-arrow-right"></i></div></div>
</div>
<footer class="app-footer"><span>© DS 2025 v3</span><button class="info-btn" onclick="openInfo()" title="Info"><i class="fa-solid fa-info"></i></button></footer>
</div>
<a id="download-link" download="tad-un-tagad.jpg"></a>
<script>
let stream=null,historicalImage=null,capturedImageData=null,currentZoom=1,isComparing=!1;
const T={toasts:{cameraActive:{lv:'Kamera aktivizēta',en:'Camera activated'},photoCaptured:{lv:'Foto uzņemts!',en:'Photo captured!'},captureFirst:{lv:'Vispirms uzņem foto!',en:'Capture first!'},saved:{lv:'Saglabāts!',en:'Saved!'},confirmReset:{lv:'Sākt no jauna?',en:'Start over?'},httpsRequired:{lv:'Nepieciešams HTTPS.',en:'HTTPS required.'}},errors:{cameraFail:{lv:'Kameras kļūda. ',en:'Camera error. '},notAllowed:{lv:'Atļauj kameru.',en:'Allow camera.'},notFound:{lv:'Nav kameras.',en:'No camera.'},notReadable:{lv:'Kamera aizņemta.',en:'Camera busy.'},generic:{lv:'Pārbaudi atļaujas.',en:'Check permissions.'},warning:{lv:'Brīdinājums',en:'Warning'}},loading:{camera:{lv:'Aktivizē kameru',en:'Starting camera'}},save:{then:{lv:'TAD',en:'THEN'},now:{lv:'TAGAD',en:'NOW'}}};
function t(c,k){return T[c]?.[k]?.[document.documentElement.getAttribute('data-lang')||'lv']||''}
function openInfo(){document.getElementById('infoModal').classList.add('active')}
function closeInfo(){document.getElementById('infoModal').classList.remove('active')}
function toggleLang(){const h=document.documentElement,k=document.getElementById('langKnob'),n=h.getAttribute('data-lang')==='lv'?'en':'lv';h.setAttribute('data-lang',n);h.setAttribute('lang',n);k.textContent=n.toUpperCase();localStorage.setItem('lang',n);document.querySelectorAll('[data-lv][data-en]').forEach(e=>e.textContent=e.id==='compareBtnText'&&isComparing?e.getAttribute('data-'+n+'-alt')||e.getAttribute('data-'+n):e.getAttribute('data-'+n))}
(()=>{const s=localStorage.getItem('lang');if(s&&s!=='lv'){document.documentElement.setAttribute('data-lang',s);document.documentElement.setAttribute('lang',s);document.getElementById('langKnob').textContent=s.toUpperCase();document.querySelectorAll('[data-lv][data-en]').forEach(e=>e.textContent=e.getAttribute('data-'+s))}})();
function toggleTheme(){const h=document.documentElement,i=document.getElementById('themeIcon');if(h.getAttribute('data-theme')==='dark'){h.setAttribute('data-theme','light');i.className='fa-solid fa-sun';localStorage.setItem('theme','light')}else{h.setAttribute('data-theme','dark');i.className='fa-solid fa-moon';localStorage.setItem('theme','dark')}}
(()=>{const s=localStorage.getItem('theme');if(s){document.documentElement.setAttribute('data-theme',s);document.getElementById('themeIcon').className=s==='light'?'fa-solid fa-sun':'fa-solid fa-moon'}})();
function showToast(m,type='success'){const to=document.getElementById('toast');to.className='toast '+type;document.getElementById('toastIcon').className=type==='success'?'fa-solid fa-circle-check':'fa-solid fa-triangle-exclamation';document.getElementById('toastText').textContent=m;requestAnimationFrame(()=>to.classList.add('show'));setTimeout(()=>to.classList.remove('show'),3e3)}
function checkSecureContext(){if(!window.isSecureContext){showError(t('toasts','httpsRequired'));return!1}return!0}
function showError(m){document.getElementById('errorContainer').innerHTML=`<div class="error-message"><h3><i class="fa-solid fa-triangle-exclamation" style="margin-right:6px"></i>${t('errors','warning')}</h3><p>${m}</p></div>`}
document.getElementById('historicalInput').addEventListener('change',function(e){const f=e.target.files[0];if(f){const r=new FileReader();r.onload=ev=>{historicalImage=ev.target.result;document.getElementById('historical-overlay').src=historicalImage;document.getElementById('historical-comparison').src=historicalImage;document.getElementById('uploadSection').classList.add('active');checkSecureContext()&&startCamera()};r.readAsDataURL(f)}});
async function startCamera(){const ec=document.getElementById('errorContainer');ec.innerHTML=`<div class="loading">${t('loading','camera')}<div class="loading-dots"><span></span><span></span><span></span></div></div>`;try{stream=await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:'environment'},width:{ideal:1920},height:{ideal:1080}},audio:!1});const v=document.getElementById('video-feed');v.srcObject=stream;v.onloadedmetadata=()=>{v.play();document.getElementById('cameraContainer').classList.add('active');document.getElementById('controlsPanel').style.display='block';document.getElementById('statusPill').classList.add('active');ec.innerHTML='';showToast(t('toasts','cameraActive'))}}catch(err){let m=t('errors','cameraFail');if(err.name==='NotAllowedError')m+=t('errors','notAllowed');else if(err.name==='NotFoundError')m+=t('errors','notFound');else if(err.name==='NotReadableError')m+=t('errors','notReadable');else m+=t('errors','generic');showError(m)}}
document.getElementById('opacitySlider').addEventListener('input',e=>{document.getElementById('historical-overlay').style.opacity=e.target.value/100;document.getElementById('opacityValue').textContent=e.target.value+'%'});
document.getElementById('zoomSlider').addEventListener('input',e=>{currentZoom=e.target.value/100;document.getElementById('video-feed').style.transform=`scale(${currentZoom})`;document.getElementById('zoomValue').textContent=currentZoom.toFixed(1)+'x'});
function capturePhoto(){const v=document.getElementById('video-feed'),c=document.getElementById('snapshot-canvas'),hi=new Image();hi.src=historicalImage;hi.onload=()=>{const tw=hi.naturalWidth,th=hi.naturalHeight,ta=tw/th;c.width=tw;c.height=th;const ctx=c.getContext('2d'),va=v.videoWidth/v.videoHeight;let sx,sy,sw,sh;if(va>ta){sh=v.videoHeight;sw=sh*ta;sx=(v.videoWidth-sw)/2;sy=0}else{sw=v.videoWidth;sh=sw/ta;sx=0;sy=(v.videoHeight-sh)/2}ctx.save();ctx.translate(tw/2,th/2);ctx.scale(currentZoom,currentZoom);ctx.translate(-tw/2,-th/2);ctx.drawImage(v,sx,sy,sw,sh,0,0,tw,th);ctx.restore();capturedImageData=c.toDataURL('image/jpeg',.95);document.getElementById('captured-image').src=capturedImageData;document.getElementById('compareBtn').style.display='inline-flex';document.getElementById('saveBtn').style.display='inline-flex';navigator.vibrate&&navigator.vibrate(50);showToast(t('toasts','photoCaptured'))}}
function toggleComparison(){const sc=document.getElementById('sliderComparison'),v=document.getElementById('video-feed'),ov=document.getElementById('historical-overlay'),ct=document.getElementById('compareBtnText'),ci=document.getElementById('compareBtnIcon'),og=document.getElementById('opacityGroup'),zg=document.getElementById('zoomGroup'),csg=document.getElementById('comparisonSliderGroup'),cap=document.getElementById('captureBtn'),rst=document.getElementById('resetBtn'),hint=document.getElementById('sliderHint'),pill=document.getElementById('statusPill'),vf=document.getElementById('viewfinder'),lang=document.documentElement.getAttribute('data-lang');if(sc.classList.contains('active')){isComparing=!1;sc.classList.remove('active');v.style.display='block';ov.style.display='block';ct.textContent=ct.getAttribute('data-'+lang);ci.className='fa-solid fa-repeat';og.style.display='block';zg.style.display='block';cap.style.display='inline-flex';rst.style.display='inline-flex';csg.style.display='none';hint.classList.remove('active');pill.classList.add('active');vf.style.display='block'}else{if(!capturedImageData){showToast(t('toasts','captureFirst'),'warning');return}isComparing=!0;document.getElementById('comparisonSlider').value=50;updateSliderComparison(50);sc.classList.add('active');v.style.display='none';ov.style.display='none';ct.textContent=ct.getAttribute('data-'+lang+'-alt');ci.className='fa-solid fa-video';og.style.display='none';zg.style.display='none';cap.style.display='none';rst.style.display='none';csg.style.display='block';hint.classList.add('active');pill.classList.remove('active');vf.style.display='none'}}
document.getElementById('comparisonSlider').addEventListener('input',e=>updateSliderComparison(parseInt(e.target.value)));
function updateSliderComparison(v){document.getElementById('sliderDivider').style.left=v+'%';document.getElementById('historical-comparison').style.clipPath=`inset(0 ${100-v}% 0 0)`;document.getElementById('captured-image').style.clipPath=`inset(0 0 0 ${v}%)`}
function saveComparison(){if(!capturedImageData){showToast(t('toasts','captureFirst'),'warning');return}const c=document.getElementById('snapshot-canvas'),ctx=c.getContext('2d'),i1=new Image(),i2=new Image();const st=getComputedStyle(document.documentElement),tc=st.getPropertyValue('--save-then').trim(),nc=st.getPropertyValue('--save-now').trim(),bg=st.getPropertyValue('--bg1').trim();i1.onload=()=>{i2.onload=()=>{const mw=Math.max(i1.width,i2.width),mh=Math.max(i1.height,i2.height);c.width=mw*2;c.height=mh;ctx.fillStyle=bg;ctx.fillRect(0,0,c.width,c.height);ctx.drawImage(i1,(mw-i1.width)/2,(mh-i1.height)/2);ctx.drawImage(i2,mw+(mw-i2.width)/2,(mh-i2.height)/2);const g=ctx.createLinearGradient(mw,0,mw,mh);g.addColorStop(0,'#6c5ce7');g.addColorStop(.5,'#a855f7');g.addColorStop(1,'#ec4899');ctx.strokeStyle=g;ctx.lineWidth=6;ctx.beginPath();ctx.moveTo(mw,0);ctx.lineTo(mw,mh);ctx.stroke();const fs=Math.max(32,mh/20);ctx.font=`bold ${fs}px sans-serif`;ctx.strokeStyle=bg;ctx.lineWidth=4;const p=30;ctx.fillStyle=tc;ctx.strokeText(t('save','then'),p,fs+p);ctx.fillText(t('save','then'),p,fs+p);ctx.fillStyle=nc;ctx.strokeText(t('save','now'),mw+p,fs+p);ctx.fillText(t('save','now'),mw+p,fs+p);document.getElementById('download-link').href=c.toDataURL('image/jpeg',.95);document.getElementById('download-link').click();navigator.vibrate&&navigator.vibrate([50,100,50]);showToast(t('toasts','saved'))};i2.src=capturedImageData};i1.src=historicalImage}
function resetApp(){if(confirm(t('toasts','confirmReset'))){stream&&stream.getTracks().forEach(t=>t.stop());isComparing=!1;document.getElementById('uploadSection').classList.remove('active');document.getElementById('cameraContainer').classList.remove('active');document.getElementById('controlsPanel').style.display='none';document.getElementById('compareBtn').style.display='none';document.getElementById('saveBtn').style.display='none';document.getElementById('sliderComparison').classList.remove('active');document.getElementById('captureBtn').style.display='inline-flex';document.getElementById('resetBtn').style.display='inline-flex';document.getElementById('errorContainer').innerHTML='';document.getElementById('sliderHint').classList.remove('active');document.getElementById('statusPill').classList.remove('active');document.getElementById('opacityGroup').style.display='block';document.getElementById('zoomGroup').style.display='block';document.getElementById('viewfinder').style.display='block';const lang=document.documentElement.getAttribute('data-lang'),ct=document.getElementById('compareBtnText');ct.textContent=ct.getAttribute('data-'+lang);historicalImage=null;capturedImageData=null;currentZoom=1;document.getElementById('opacitySlider').value=50;document.getElementById('opacityValue').textContent='50%';document.getElementById('zoomSlider').value=100;document.getElementById('zoomValue').textContent='1.0x';document.getElementById('historicalInput').value='';document.getElementById('video-feed').style.transform='scale(1)'}}
document.body.addEventListener('touchmove',e=>{e.target.closest('.camera-container')&&e.preventDefault()},{passive:!1});
'serviceWorker'in navigator&&window.addEventListener('load',()=>navigator.serviceWorker.register('sw.js').catch(()=>{}));
</script>
</body>
</html>